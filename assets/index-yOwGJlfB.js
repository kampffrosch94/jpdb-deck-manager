var Go=Object.defineProperty;var Jo=(i,n,o)=>n in i?Go(i,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[n]=o;var he=(i,n,o)=>(Jo(i,typeof n!="symbol"?n+"":n,o),o);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))a(c);new MutationObserver(c=>{for(const f of c)if(f.type==="childList")for(const v of f.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&a(v)}).observe(document,{childList:!0,subtree:!0});function o(c){const f={};return c.integrity&&(f.integrity=c.integrity),c.referrerPolicy&&(f.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?f.credentials="include":c.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function a(c){if(c.ep)return;c.ep=!0;const f=o(c);fetch(c.href,f)}})();function Ie(){}function Qo(i,n){for(const o in n)i[o]=n[o];return i}function ho(i){return i()}function Bi(){return Object.create(null)}function wt(i){i.forEach(ho)}function ii(i){return typeof i=="function"}function Pt(i,n){return i!=i?n==n:i!==n||i&&typeof i=="object"||typeof i=="function"}function Xo(i){return Object.keys(i).length===0}function On(i,...n){if(i==null){for(const a of n)a(void 0);return Ie}const o=i.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function St(i){let n;return On(i,o=>n=o)(),n}function st(i,n,o){i.$$.on_destroy.push(On(n,o))}function Zo(i,n,o,a){if(i){const c=po(i,n,o,a);return i[0](c)}}function po(i,n,o,a){return i[1]&&a?Qo(o.ctx.slice(),i[1](a(n))):o.ctx}function es(i,n,o,a){if(i[2]&&a){const c=i[2](a(o));if(n.dirty===void 0)return c;if(typeof c=="object"){const f=[],v=Math.max(n.dirty.length,c.length);for(let _=0;_<v;_+=1)f[_]=n.dirty[_]|c[_];return f}return n.dirty|c}return n.dirty}function ts(i,n,o,a,c,f){if(c){const v=po(n,o,a,f);i.p(v,c)}}function ns(i){if(i.ctx.length>32){const n=[],o=i.ctx.length/32;for(let a=0;a<o;a++)n[a]=-1;return n}return-1}function bt(i,n,o){return i.set(o),n}function w(i,n){i.appendChild(n)}function Q(i,n,o){i.insertBefore(n,o||null)}function G(i){i.parentNode&&i.parentNode.removeChild(i)}function Sn(i,n){for(let o=0;o<i.length;o+=1)i[o]&&i[o].d(n)}function B(i){return document.createElement(i)}function ne(i){return document.createTextNode(i)}function Y(){return ne(" ")}function mo(){return ne("")}function De(i,n,o,a){return i.addEventListener(n,o,a),()=>i.removeEventListener(n,o,a)}function re(i,n,o){o==null?i.removeAttribute(n):i.getAttribute(n)!==o&&i.setAttribute(n,o)}function rs(i){let n;return{p(...o){n=o,n.forEach(a=>i.push(a))},r(){n.forEach(o=>i.splice(i.indexOf(o),1))}}}function ct(i){return i===""?null:+i}function is(i){return Array.from(i.childNodes)}function Te(i,n){n=""+n,i.data!==n&&(i.data=n)}function Ve(i,n){i.value=n??""}function qn(i,n,o,a){o==null?i.style.removeProperty(n):i.style.setProperty(n,o,a?"important":"")}function Mi(i,n,o){for(let a=0;a<i.options.length;a+=1){const c=i.options[a];if(c.__value===n){c.selected=!0;return}}(!o||n!==void 0)&&(i.selectedIndex=-1)}function os(i){const n=i.querySelector(":checked");return n&&n.__value}function vn(i,n,o){i.classList.toggle(n,!!o)}function ss(i,n,{bubbles:o=!1,cancelable:a=!1}={}){return new CustomEvent(i,{detail:n,bubbles:o,cancelable:a})}let Mn;function Bn(i){Mn=i}function as(){if(!Mn)throw new Error("Function called outside component initialization");return Mn}function vo(){const i=as();return(n,o,{cancelable:a=!1}={})=>{const c=i.$$.callbacks[n];if(c){const f=ss(n,o,{cancelable:a});return c.slice().forEach(v=>{v.call(i,f)}),!f.defaultPrevented}return!0}}const _n=[],Fi=[];let bn=[];const Ii=[],us=Promise.resolve();let ei=!1;function ls(){ei||(ei=!0,us.then(go))}function mr(i){bn.push(i)}const Xr=new Set;let gn=0;function go(){if(gn!==0)return;const i=Mn;do{try{for(;gn<_n.length;){const n=_n[gn];gn++,Bn(n),cs(n.$$)}}catch(n){throw _n.length=0,gn=0,n}for(Bn(null),_n.length=0,gn=0;Fi.length;)Fi.pop()();for(let n=0;n<bn.length;n+=1){const o=bn[n];Xr.has(o)||(Xr.add(o),o())}bn.length=0}while(_n.length);for(;Ii.length;)Ii.pop()();ei=!1,Xr.clear(),Bn(i)}function cs(i){if(i.fragment!==null){i.update(),wt(i.before_update);const n=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,n),i.after_update.forEach(mr)}}function fs(i){const n=[],o=[];bn.forEach(a=>i.indexOf(a)===-1?n.push(a):o.push(a)),o.forEach(a=>a()),bn=n}const dr=new Set;let nn;function wn(){nn={r:0,c:[],p:nn}}function kn(){nn.r||wt(nn.c),nn=nn.p}function Ce(i,n){i&&i.i&&(dr.delete(i),i.i(n))}function je(i,n,o,a){if(i&&i.o){if(dr.has(i))return;dr.add(i),nn.c.push(()=>{dr.delete(i),a&&(o&&i.d(1),a())}),i.o(n)}else a&&a()}function Ct(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function Ge(i){i&&i.c()}function We(i,n,o){const{fragment:a,after_update:c}=i.$$;a&&a.m(n,o),mr(()=>{const f=i.$$.on_mount.map(ho).filter(ii);i.$$.on_destroy?i.$$.on_destroy.push(...f):wt(f),i.$$.on_mount=[]}),c.forEach(mr)}function Ye(i,n){const o=i.$$;o.fragment!==null&&(fs(o.after_update),wt(o.on_destroy),o.fragment&&o.fragment.d(n),o.on_destroy=o.fragment=null,o.ctx=[])}function hs(i,n){i.$$.dirty[0]===-1&&(_n.push(i),ls(),i.$$.dirty.fill(0)),i.$$.dirty[n/31|0]|=1<<n%31}function xt(i,n,o,a,c,f,v=null,_=[-1]){const g=Mn;Bn(i);const d=i.$$={fragment:null,ctx:[],props:f,update:Ie,not_equal:c,bound:Bi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(g?g.$$.context:[])),callbacks:Bi(),dirty:_,skip_bound:!1,root:n.target||g.$$.root};v&&v(d.root);let y=!1;if(d.ctx=o?o(i,n.props||{},(p,E,...I)=>{const N=I.length?I[0]:E;return d.ctx&&c(d.ctx[p],d.ctx[p]=N)&&(!d.skip_bound&&d.bound[p]&&d.bound[p](N),y&&hs(i,p)),E}):[],d.update(),y=!0,wt(d.before_update),d.fragment=a?a(d.ctx):!1,n.target){if(n.hydrate){const p=is(n.target);d.fragment&&d.fragment.l(p),p.forEach(G)}else d.fragment&&d.fragment.c();n.intro&&Ce(i.$$.fragment),We(i,n.target,n.anchor),go()}Bn(g)}class At{constructor(){he(this,"$$");he(this,"$$set")}$destroy(){Ye(this,1),this.$destroy=Ie}$on(n,o){if(!ii(o))return Ie;const a=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return a.push(o),()=>{const c=a.indexOf(o);c!==-1&&a.splice(c,1)}}$set(n){this.$$set&&!Xo(n)&&(this.$$.skip_bound=!0,this.$$set(n),this.$$.skip_bound=!1)}}const ds="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ds);const yn=[];function ps(i,n){return{subscribe:vt(i,n).subscribe}}function vt(i,n=Ie){let o;const a=new Set;function c(_){if(Pt(i,_)&&(i=_,o)){const g=!yn.length;for(const d of a)d[1](),yn.push(d,i);if(g){for(let d=0;d<yn.length;d+=2)yn[d][0](yn[d+1]);yn.length=0}}}function f(_){c(_(i))}function v(_,g=Ie){const d=[_,g];return a.add(d),a.size===1&&(o=n(c,f)||Ie),_(i),()=>{a.delete(d),a.size===0&&o&&(o(),o=null)}}return{set:c,update:f,subscribe:v}}function $t(i,n,o){const a=!Array.isArray(i),c=a?[i]:i;if(!c.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const f=n.length<2;return ps(o,(v,_)=>{let g=!1;const d=[];let y=0,p=Ie;const E=()=>{if(y)return;p();const N=n(a?d[0]:d,v,_);f?v(N):p=ii(N)?N:Ie},I=c.map((N,T)=>On(N,H=>{d[T]=H,y&=~(1<<T),g&&E()},()=>{y|=1<<T}));return g=!0,E(),function(){wt(I),p(),g=!1}})}const sn=vt(""),ti=vt(!1),zt=vt(""),gt=vt([]),yo=i=>i==null||i==="",ms=i=>!yo(i),rn=(i,n)=>{const o=n??i.toString();if(typeof i=="string")return{callback:a=>a[i],identifier:o,key:i};if(typeof i=="function")return{callback:i,identifier:o,key:void 0};throw new Error(`Invalid field argument: ${String(i)}`)},on={isLike:(i,n)=>Ot(i).indexOf(Ot(n))>-1,isNotLike:(i,n)=>Ot(i).indexOf(Ot(n))===-1,startsWith:(i,n)=>Ot(i).startsWith(Ot(n)),endsWith:(i,n)=>Ot(i).endsWith(Ot(n)),isEqualTo:(i,n)=>Ot(i)===Ot(n),isNotEqualTo:(i,n)=>Ot(i)!==Ot(n),isGreaterThan:(i,n)=>en(i)?!1:i>n,isGreaterThanOrEqualTo:(i,n)=>en(i)?!1:i>=n,isLessThan:(i,n)=>en(i)?!1:i<n,isLessThanOrEqualTo:(i,n)=>en(i)?!1:i<=n,isBetween:(i,n)=>{if(en(i))return!1;const[o,a]=n;return i>=o&&i<=a},isStrictlyBetween:(i,n)=>{if(en(i))return!1;const[o,a]=n;return i>o&&i<a},isTrue:(i,n)=>i===!0,isFalse:(i,n)=>i===!1,isNull:(i,n)=>i==null,isNotNull:(i,n)=>i!=null,whereIn:(i,n=[])=>{if(en(i)||n.length===0)return!1;for(const{value:o,comparator:a}of n)if(a(i,o))return!0;return!1},contains:(i,n)=>on.isLike(i,n)};function Ot(i=null){return String(i).toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function en(i){if(i==null)return!0}class vs{constructor(){he(this,"events",{change:[],clearFilters:[],clearSearch:[]});he(this,"triggerChange",vt(0))}add(n,o){this.events[n].push(o)}trigger(n){for(const o of this.events[n])o();n==="change"&&this.triggerChange.update(o=>o+1)}}class gs{constructor(n,o){he(this,"event");he(this,"rowsPerPage");he(this,"pageNumber");he(this,"search");he(this,"filters");he(this,"filterCount");he(this,"rawRows");he(this,"filteredRows");he(this,"pagedRows");he(this,"rowCount");he(this,"pages");he(this,"pagesWithEllipsis");he(this,"pageCount");he(this,"sort");he(this,"selected");he(this,"selectScope");he(this,"isAllSelected");this.event=new vs,this.rowsPerPage=vt(o.rowsPerPage),this.pageNumber=vt(1),this.search=vt({}),this.filters=vt([]),this.filterCount=this.createFilterCount(),this.rawRows=vt(n),this.filteredRows=this.createFilteredRows(),this.pagedRows=this.createPagedRows(),this.rowCount=this.createRowCount(),this.pages=this.createPages(),this.pagesWithEllipsis=this.createPagesWithEllipsis(),this.pageCount=this.createPageCount(),this.sort=vt({}),this.selected=vt([]),this.selectScope=vt("all"),this.isAllSelected=this.createIsAllSelected()}createFilterCount(){return $t(this.filters,n=>n.length)}createFilteredRows(){return $t([this.rawRows,this.search,this.filters],([n,o,a])=>(o.value&&(n=n.filter(c=>(o.scope??Object.keys(c)).map(_=>{const{callback:g}=rn(_);return g}).some(_=>this.match(_(c),o.value))),this.pageNumber.set(1),this.selected.set([]),this.event.trigger("change")),a.length>0&&(a.forEach(c=>n=n.filter(f=>{const v=c.callback(f);return this.match(v,c.value,c.comparator)})),this.pageNumber.set(1),this.selected.set([]),this.event.trigger("change")),n))}match(n,o,a=null){if(yo(o))return!0;if(!n&&a)return a(n,o);if(n){if(typeof n=="object")return Object.keys(n).some(c=>this.match(n[c],o,a))}else return on.isLike(n,o);return a?a(n,o):on.isLike(n,o)}createPagedRows(){return $t([this.filteredRows,this.rowsPerPage,this.pageNumber],([n,o,a])=>o?n.slice((a-1)*o,a*o):n)}createRowCount(){return $t([this.filteredRows,this.pageNumber,this.rowsPerPage],([n,o,a])=>{const c=n.length;return a?{total:c,start:o*a-a+1,end:Math.min(o*a,n.length)}:{total:c,start:1,end:c}})}createPages(){return $t([this.rowsPerPage,this.filteredRows],([n,o])=>n?Array.from(Array(Math.ceil(o.length/n))).map((c,f)=>f+1):[1])}createPagesWithEllipsis(){return $t([this.pages,this.pageNumber],([n,o])=>{if(n.length<=7)return n;const a=null,c=1,f=n.length;return o<=4?[...n.slice(0,5),a,f]:o<n.length-3?[c,a,...n.slice(o-2,o+1),a,f]:[c,a,...n.slice(n.length-5,n.length)]})}createPageCount(){return $t(this.pages,n=>n.length)}createIsAllSelected(){return $t([this.selected,this.pagedRows,this.filteredRows,this.selectScope],([n,o,a,c])=>{const f=c==="currentPage"?o.length:a.length;return f===n.length&&f!==0})}}class ys{constructor(n){he(this,"rawRows");he(this,"event");he(this,"sort");he(this,"backup");this.rawRows=n.rawRows,this.event=n.event,this.sort=n.sort,this.backup=[]}set(n=null,o){if(!n)return;const a=St(this.sort),{identifier:c}=rn(n,o);a.identifier!==c&&this.sort.update(f=>f.direction=null),a.direction===null||a.direction==="desc"?this.asc(n,o):a.direction==="asc"&&this.desc(n,o)}asc(n,o){if(!n)return;const{identifier:a,callback:c,key:f}=rn(n,o);this.sort.set({identifier:a,callback:c,direction:"asc",key:f}),this.rawRows.update(v=>(v.sort((_,g)=>{const[d,y]=[c(_),c(g)];return d===y?0:d===null?1:y===null?-1:typeof d=="boolean"?d===!1?1:-1:typeof d=="string"?d.localeCompare(y):typeof d=="number"?d-y:typeof d=="object"?JSON.stringify(d).localeCompare(JSON.stringify(y)):String(d).localeCompare(String(y))}),v)),this.log({identifier:a,callback:c,direction:"asc"}),this.event.trigger("change")}desc(n,o){if(!n)return;const{identifier:a,callback:c,key:f}=rn(n,o);this.sort.set({identifier:a,callback:c,direction:"desc",key:f}),this.rawRows.update(v=>(v.sort((_,g)=>{const[d,y]=[c(_),c(g)];return d===y?0:d===null?1:y===null?-1:typeof y=="boolean"?y===!1?1:-1:typeof y=="string"?y.localeCompare(d):typeof y=="number"?y-d:typeof y=="object"?JSON.stringify(y).localeCompare(JSON.stringify(d)):String(y).localeCompare(String(d))}),v)),this.log({identifier:a,callback:c,direction:"desc"}),this.event.trigger("change")}apply(n=null){if(n)switch(n.direction){case"asc":return this.asc(n.orderBy);case"desc":return this.desc(n.orderBy);default:return this.set(n.orderBy)}else this.restore()}clear(){this.backup=[],this.sort.set({})}define(n,o="asc"){if(!n)return;const{identifier:a,callback:c,key:f}=rn(n);this.sort.set({identifier:a,callback:c,direction:o,key:f})}restore(){for(const n of this.backup){const{key:o,callback:a,direction:c}=n,f=o??a;this[c](f)}}log(n){if(this.backup=this.backup.filter(o=>o.identifier!==n.identifier),this.backup.length>=3){const[o,a,c]=this.backup;this.backup=[a,c,n]}else this.backup=[...this.backup,n]}}class _s{constructor(n){he(this,"filteredRows");he(this,"pagedRows");he(this,"selected");he(this,"scope");he(this,"isAllSelected");he(this,"event");this.filteredRows=n.filteredRows,this.pagedRows=n.pagedRows,this.selected=n.selected,this.scope=n.selectScope,this.isAllSelected=n.isAllSelected,this.event=n.event}set(n){const o=St(this.selected);o.includes(n)?this.selected.set(o.filter(a=>a!==n)):this.selected.set([n,...o])}all(n=null){if(St(this.isAllSelected))return this.clear();const a=St(this.scope),c=St(a==="currentPage"?this.pagedRows:this.filteredRows);a==="currentPage"&&this.event.add("change",()=>this.clear()),n?this.selected.set(c.map(f=>f[n])):this.selected.set(c)}clear(){this.selected.set([])}}class bs{constructor(n){he(this,"pageNumber");he(this,"rowCount");he(this,"rowsPerPage");he(this,"event");this.pageNumber=n.pageNumber,this.rowCount=n.rowCount,this.rowsPerPage=n.rowsPerPage,this.event=n.event}goto(n){this.pageNumber.update(o=>{const a=St(this.rowsPerPage);if(a){const c=St(this.rowCount).total;n>=1&&n<=Math.ceil(c/a)&&(o=n,this.event.trigger("change"))}return o})}previous(){const n=St(this.pageNumber)-1;this.goto(n)}next(){const n=St(this.pageNumber)+1;this.goto(n)}}class ws{constructor(n){he(this,"search");he(this,"event");this.search=n.search,this.event=n.event}set(n,o=null){this.search.update(a=>(a={value:n??"",scope:o??null},a))}clear(){this.search.set({value:null,scope:null}),this.event.trigger("change"),this.event.trigger("clearSearch")}}class ks{constructor(n){he(this,"filters");he(this,"event");he(this,"collection");this.filters=n.filters,this.event=n.event}set(n,o,a=null,c){const{callback:f,identifier:v,key:_}=rn(o,c),g={value:n,identifier:v,callback:f,comparator:a,key:_};this.filters.update(d=>(d=d.filter(y=>y.identifier!==v),ms(n)&&d.push(g),d))}clear(){this.filters.set([]),this.event.trigger("change"),this.event.trigger("clearFilters")}get(){return this.collection?this.collection:(this.collection=this.createCollection(),this.collection)}createCollection(){return $t(this.filters,n=>n.map(({value:o,callback:a,key:c,comparator:f})=>({value:o,filterBy:c??a,check:f?f.name:"isLike"})))}}class Os{constructor(n,o,a){he(this,"filterHandler");he(this,"filterBy");he(this,"uid");he(this,"comparator");he(this,"callback");this.filterHandler=n,this.filterBy=o,this.uid="f_"+Math.random().toString(28).substring(2),this.comparator=a??on.isLike,this.callback=()=>null}set(n,o){o&&(this.comparator=o),this.filterHandler.set(n,this.filterBy,this.comparator,this.uid)}clear(){this.callback(),this.filterHandler.set(void 0,this.filterBy)}on(n,o){this.callback=o}}class Ss{constructor(n,o){he(this,"filterHandler");he(this,"criteria");he(this,"filterBy");he(this,"selected");this.filterHandler=n,this.filterBy=o,this.criteria=[],this.selected=vt([])}set(n,o=on.isLike){if(this.criteria.find(a=>a.value===n)?this.criteria=this.criteria.filter(a=>a.value!==n):this.criteria=[{value:n,comparator:o},...this.criteria],this.criteria.length===0)return this.clear();this.filterHandler.set(this.criteria,this.filterBy,on.whereIn),this.selected.set(this.criteria.map(a=>a.value))}getSelected(){return this.selected}clear(){this.criteria=[],this.selected.set([]),this.filterHandler.set(void 0,this.filterBy,on.whereIn)}}class Cs{constructor(n,o,a){he(this,"rawRows");he(this,"filteredRows");he(this,"callback");he(this,"precision");this.rawRows=n.rawRows,this.filteredRows=n.filteredRows,this.callback=rn(o).callback,this.precision=a.precision}distinct(n=null){const a=St(this.rawRows).map(v=>this.callback(v)),f=(n?n(a):a).reduce((v,_)=>(v[_]=(v[_]??0)+1,v),{});return Object.entries(f).map(([v,_])=>({value:v,count:_}))}avg(n=null){return $t(this.filteredRows,o=>{if(o.length===0)return 0;const a=o.map(f=>this.callback(f)).filter(Boolean),c=n?n(a):a;return this.round(c.reduce((f,v)=>f+v,0)/c.length)})}sum(n=null){return $t(this.filteredRows,o=>{const a=o.map(f=>this.callback(f)),c=n?n(a):a;return this.round(c.reduce((f,v)=>f+v,0))})}bounds(n=null){const a=St(this.rawRows).map(f=>this.callback(f)),c=n?n(a):a;return[Math.min(...c.filter(Boolean)),Math.max(...c.filter(Boolean))]}setPrecision(n){this.precision=n}round(n){if(this.precision===0)return Math.round(n);const o=Math.pow(10,this.precision);return Math.round((n+Number.EPSILON)*o)/o}}class vr{constructor(n=[],o={rowsPerPage:null}){he(this,"context");he(this,"sortHandler");he(this,"selectHandler");he(this,"pageHandler");he(this,"searchHandler");he(this,"filterHandler");he(this,"i18n");this.i18n=this.translate(o.i18n),this.context=new gs(n,o),this.sortHandler=new ys(this.context),this.selectHandler=new _s(this.context),this.pageHandler=new bs(this.context),this.searchHandler=new ws(this.context),this.filterHandler=new ks(this.context)}setRows(n){this.context.rawRows.set(n),this.context.event.trigger("change"),this.applySort()}getRows(){return this.context.pagedRows}getAllRows(){return this.context.filteredRows}getRowCount(){return this.context.rowCount}getRowsPerPage(){return this.context.rowsPerPage}getPages(n={ellipsis:!1}){return n.ellipsis?this.context.pagesWithEllipsis:this.context.pages}getPageCount(){return this.context.pageCount}getPageNumber(){return this.context.pageNumber}setPage(n){switch(n){case"previous":return this.pageHandler.previous();case"next":return this.pageHandler.next();default:return this.pageHandler.goto(n)}}search(n,o=null){this.searchHandler.set(n,o)}clearSearch(){this.searchHandler.clear()}sort(n,o){this.setPage(1),this.sortHandler.set(n,o)}sortAsc(n,o){this.setPage(1),this.sortHandler.asc(n,o)}sortDesc(n,o){this.setPage(1),this.sortHandler.desc(n,o)}getSort(){return this.context.sort}applySort(n=null){this.sortHandler.apply(n)}defineSort(n,o){this.sortHandler.define(n,o)}clearSort(){this.sortHandler.clear()}filter(n,o,a=null){this.filterHandler.set(n,o,a)}getFilters(){return this.filterHandler.get()}createFilter(n,o){return new Os(this.filterHandler,n,o)}createAdvancedFilter(n){return new Ss(this.filterHandler,n)}getFilterCount(){return this.context.filterCount}clearFilters(){this.filterHandler.clear()}select(n){this.selectHandler.set(n)}getSelected(){return this.context.selected}selectAll(n={}){this.context.selectScope.set(n.scope==="currentPage"?"currentPage":"all"),this.selectHandler.all(n.selectBy??null)}isAllSelected(){return this.context.isAllSelected}on(n,o){this.context.event.add(n,o)}createCalculation(n,o=null){return new Cs(this.context,n,{precision:(o==null?void 0:o.precision)??2})}translate(n){return{search:"Search...",show:"Show",entries:"entries",filter:"Filter",rowCount:"Showing {start} to {end} of {total} entries",noRows:"No entries found",previous:"Previous",next:"Next",...n}}update(n){console.log("%c%s","color:#e65100;background:#fff3e0;font-size:12px;border-radius:4px;padding:4px;text-align:center;","DataHandler.update(data) method is deprecated. Please use DataHandler.setRows(data) instead"),this.context.rawRows.set(n)}applySorting(n=null){this.applySort(n)}getSorted(){return this.getSort()}getTriggerChange(){return this.context.event.triggerChange}}function $s(i){let n,o,a,c,f,v,_,g;const d=i[6].default,y=Zo(d,i,i[5],null);return{c(){n=B("th"),o=B("div"),a=B("strong"),y&&y.c(),c=Y(),f=B("span"),re(f,"class","svelte-d56bz"),vn(f,"asc",i[2].direction==="asc"),vn(f,"desc",i[2].direction==="desc"),re(o,"class","flex svelte-d56bz"),re(n,"class","svelte-d56bz"),vn(n,"active",i[2].identifier===i[3])},m(p,E){Q(p,n,E),w(n,o),w(o,a),y&&y.m(a,null),w(o,c),w(o,f),v=!0,_||(g=De(n,"click",i[7]),_=!0)},p(p,[E]){y&&y.p&&(!v||E&32)&&ts(y,d,p,p[5],v?es(d,p[5],E,null):ns(p[5]),null),(!v||E&4)&&vn(f,"asc",p[2].direction==="asc"),(!v||E&4)&&vn(f,"desc",p[2].direction==="desc"),(!v||E&12)&&vn(n,"active",p[2].identifier===p[3])},i(p){v||(Ce(y,p),v=!0)},o(p){je(y,p),v=!1},d(p){p&&G(n),y&&y.d(p),_=!1,g()}}}function Ps(i,n,o){let a,{$$slots:c={},$$scope:f}=n,{handler:v}=n,{orderBy:_=null}=n;const g=_==null?void 0:_.toString(),d=v.getSort();st(i,d,p=>o(2,a=p));const y=()=>v.sort(_);return i.$$set=p=>{"handler"in p&&o(0,v=p.handler),"orderBy"in p&&o(1,_=p.orderBy),"$$scope"in p&&o(5,f=p.$$scope)},[v,_,a,g,d,f,c,y]}class mt extends At{constructor(n){super(),xt(this,n,Ps,$s,Pt,{handler:0,orderBy:1})}}function Ni(i,n,o){const a=i.slice();return a[18]=n[o],a}function Es(i){let n;return{c(){n=ne("deck name")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function js(i){let n;return{c(){n=ne("coverage")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Ds(i){let n,o,a;return{c(){n=ne("learning"),o=B("br"),a=ne("coverage")},m(c,f){Q(c,n,f),Q(c,o,f),Q(c,a,f)},p:Ie,d(c){c&&(G(n),G(o),G(a))}}}function xs(i){let n;return{c(){n=ne("vocab")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function As(i){let n;return{c(){n=ne("words")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Rs(i){let n;return{c(){n=ne("is_built_in")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Li(i){let n,o,a,c=i[18].name+"",f,v,_,g,d,y,p,E=i[18].known_coverage.toFixed(1)+"",I,N,T,H=i[18].learning_coverage.toFixed(1)+"",W,ee,V,X=i[18].vocab_count+"",oe,K,R,F=i[18].word_count+"",ve,Pe,_e,Ke=i[18].is_built_in+"",$e,Me,be,Fe;function qe(...me){return i[16](i[18],...me)}return{c(){n=B("tr"),o=B("td"),a=B("a"),f=ne(c),v=Y(),_=B("a"),g=ne("[jpdb]"),y=Y(),p=B("td"),I=ne(E),N=Y(),T=B("td"),W=ne(H),ee=Y(),V=B("td"),oe=ne(X),K=Y(),R=B("td"),ve=ne(F),Pe=Y(),_e=B("td"),$e=ne(Ke),Me=Y(),re(a,"href","#"),re(_,"target","_blank"),re(_,"href",d="https://jpdb.io/deck?id="+i[18].id),re(o,"class","svelte-1dyr16w"),qn(p,"text-align","right"),re(p,"class","svelte-1dyr16w"),qn(T,"text-align","right"),re(T,"class","svelte-1dyr16w"),qn(V,"text-align","right"),re(V,"class","svelte-1dyr16w"),qn(R,"text-align","right"),re(R,"class","svelte-1dyr16w"),qn(_e,"text-align","center"),re(_e,"class","svelte-1dyr16w"),re(n,"class","svelte-1dyr16w")},m(me,pe){Q(me,n,pe),w(n,o),w(o,a),w(a,f),w(o,v),w(o,_),w(_,g),w(n,y),w(n,p),w(p,I),w(n,N),w(n,T),w(T,W),w(n,ee),w(n,V),w(V,oe),w(n,K),w(n,R),w(R,ve),w(n,Pe),w(n,_e),w(_e,$e),w(n,Me),be||(Fe=De(a,"click",qe),be=!0)},p(me,pe){i=me,pe&256&&c!==(c=i[18].name+"")&&Te(f,c),pe&256&&d!==(d="https://jpdb.io/deck?id="+i[18].id)&&re(_,"href",d),pe&256&&E!==(E=i[18].known_coverage.toFixed(1)+"")&&Te(I,E),pe&256&&H!==(H=i[18].learning_coverage.toFixed(1)+"")&&Te(W,H),pe&256&&X!==(X=i[18].vocab_count+"")&&Te(oe,X),pe&256&&F!==(F=i[18].word_count+"")&&Te(ve,F),pe&256&&Ke!==(Ke=i[18].is_built_in+"")&&Te($e,Ke)},d(me){me&&G(n),be=!1,Fe()}}}function Hi(i){let n,o,a;return{c(){n=B("button"),n.textContent="add all"},m(c,f){Q(c,n,f),o||(a=De(n,"click",i[17]),o=!0)},p:Ie,d(c){c&&G(n),o=!1,a()}}}function Ts(i){let n,o,a,c=i[7].total+"",f,v,_=i[0].length+"",g,d,y,p,E,I,N,T,H,W,ee,V,X,oe,K,R,F,ve,Pe,_e,Ke,$e,Me,be,Fe,qe,me;V=new mt({props:{handler:i[1],orderBy:"name",$$slots:{default:[Es]},$$scope:{ctx:i}}}),oe=new mt({props:{handler:i[1],orderBy:"known_coverage",$$slots:{default:[js]},$$scope:{ctx:i}}}),R=new mt({props:{handler:i[1],orderBy:"learning_coverage",$$slots:{default:[Ds]},$$scope:{ctx:i}}}),ve=new mt({props:{handler:i[1],orderBy:"vocab_count",$$slots:{default:[xs]},$$scope:{ctx:i}}}),_e=new mt({props:{handler:i[1],orderBy:"word_count",$$slots:{default:[As]},$$scope:{ctx:i}}}),$e=new mt({props:{handler:i[1],orderBy:"is_built_in",$$slots:{default:[Rs]},$$scope:{ctx:i}}});let pe=Ct(i[8]),ue=[];for(let J=0;J<pe.length;J+=1)ue[J]=Li(Ni(i,pe,J));let ge=i[0].length>0&&Hi(i);return{c(){n=B("div"),o=B("h3"),a=ne("Decklist (showing "),f=ne(c),v=ne(" of "),g=ne(_),d=ne(")"),y=ne(`
    Min coverage:
    `),p=B("input"),E=ne(`
    Min learning coverage:
    `),I=B("input"),N=ne(`
    Filter builtin:
    `),T=B("input"),H=Y(),W=B("table"),ee=B("tr"),Ge(V.$$.fragment),X=Y(),Ge(oe.$$.fragment),K=Y(),Ge(R.$$.fragment),F=Y(),Ge(ve.$$.fragment),Pe=Y(),Ge(_e.$$.fragment),Ke=Y(),Ge($e.$$.fragment),Me=Y();for(let J=0;J<ue.length;J+=1)ue[J].c();be=Y(),ge&&ge.c(),re(p,"type","number"),re(I,"type","number"),re(T,"type","checkbox"),re(ee,"class","svelte-1dyr16w"),re(W,"class","svelte-1dyr16w")},m(J,ce){Q(J,n,ce),w(n,o),w(o,a),w(o,f),w(o,v),w(o,g),w(o,d),w(n,y),w(n,p),Ve(p,i[2]),w(n,E),w(n,I),Ve(I,i[3]),w(n,N),w(n,T),T.checked=i[4],w(n,H),w(n,W),w(W,ee),We(V,ee,null),w(ee,X),We(oe,ee,null),w(ee,K),We(R,ee,null),w(ee,F),We(ve,ee,null),w(ee,Pe),We(_e,ee,null),w(ee,Ke),We($e,ee,null),w(W,Me);for(let et=0;et<ue.length;et+=1)ue[et]&&ue[et].m(W,null);w(n,be),ge&&ge.m(n,null),Fe=!0,qe||(me=[De(p,"input",i[10]),De(p,"input",i[11]),De(I,"input",i[12]),De(I,"input",i[13]),De(T,"change",i[14]),De(T,"input",i[15])],qe=!0)},p(J,[ce]){(!Fe||ce&128)&&c!==(c=J[7].total+"")&&Te(f,c),(!Fe||ce&1)&&_!==(_=J[0].length+"")&&Te(g,_),ce&4&&ct(p.value)!==J[2]&&Ve(p,J[2]),ce&8&&ct(I.value)!==J[3]&&Ve(I,J[3]),ce&16&&(T.checked=J[4]);const et={};ce&2&&(et.handler=J[1]),ce&2097152&&(et.$$scope={dirty:ce,ctx:J}),V.$set(et);const Le={};ce&2&&(Le.handler=J[1]),ce&2097152&&(Le.$$scope={dirty:ce,ctx:J}),oe.$set(Le);const Be={};ce&2&&(Be.handler=J[1]),ce&2097152&&(Be.$$scope={dirty:ce,ctx:J}),R.$set(Be);const tt={};ce&2&&(tt.handler=J[1]),ce&2097152&&(tt.$$scope={dirty:ce,ctx:J}),ve.$set(tt);const ft={};ce&2&&(ft.handler=J[1]),ce&2097152&&(ft.$$scope={dirty:ce,ctx:J}),_e.$set(ft);const fe={};if(ce&2&&(fe.handler=J[1]),ce&2097152&&(fe.$$scope={dirty:ce,ctx:J}),$e.$set(fe),ce&768){pe=Ct(J[8]);let Je;for(Je=0;Je<pe.length;Je+=1){const at=Ni(J,pe,Je);ue[Je]?ue[Je].p(at,ce):(ue[Je]=Li(at),ue[Je].c(),ue[Je].m(W,null))}for(;Je<ue.length;Je+=1)ue[Je].d(1);ue.length=pe.length}J[0].length>0?ge?ge.p(J,ce):(ge=Hi(J),ge.c(),ge.m(n,null)):ge&&(ge.d(1),ge=null)},i(J){Fe||(Ce(V.$$.fragment,J),Ce(oe.$$.fragment,J),Ce(R.$$.fragment,J),Ce(ve.$$.fragment,J),Ce(_e.$$.fragment,J),Ce($e.$$.fragment,J),Fe=!0)},o(J){je(V.$$.fragment,J),je(oe.$$.fragment,J),je(R.$$.fragment,J),je(ve.$$.fragment,J),je(_e.$$.fragment,J),je($e.$$.fragment,J),Fe=!1},d(J){J&&G(n),Ye(V),Ye(oe),Ye(R),Ye(ve),Ye(_e),Ye($e),Sn(ue,J),ge&&ge.d(),qe=!1,wt(me)}}}function Ks(i,n,o){let a,c=Ie,f=()=>(c(),c=On(H,ve=>o(7,a=ve)),H),v,_=Ie,g=()=>(_(),_=On(T,ve=>o(8,v=ve)),T),d;st(i,gt,ve=>o(9,d=ve)),i.$$.on_destroy.push(()=>c()),i.$$.on_destroy.push(()=>_());let y=0,p=0,E=!1,{decks:I}=n,N=new vr(I),T=N.getRows();g();let H=N.getRowCount();f();function W(){y=ct(this.value),o(2,y)}const ee=()=>N.filter(y,"known_coverage",(ve,Pe)=>ve>Pe);function V(){p=ct(this.value),o(3,p)}const X=()=>N.filter(p,"learning_coverage",(ve,Pe)=>ve>Pe);function oe(){E=this.checked,o(4,E)}const K=()=>N.filter(E,"is_built_in",(ve,Pe)=>ve||ve!==Pe),R=(ve,Pe)=>{Pe.preventDefault(),d.push(ve),gt.set(d)},F=async()=>{bt(gt,d=d.concat(v),d)};return i.$$set=ve=>{"decks"in ve&&o(0,I=ve.decks)},i.$$.update=()=>{i.$$.dirty&3&&I.length>0&&(o(1,N=new vr(I)),g(o(5,T=N.getRows())),f(o(6,H=N.getRowCount())))},[I,N,y,p,E,T,H,a,v,d,W,ee,V,X,oe,K,R,F]}class qs extends At{constructor(n){super(),xt(this,n,Ks,Ts,Pt,{decks:0})}}async function an(i,n,o){let a=new Headers;return a.set("Authorization","Bearer "+o),a.set("Content-Type","application/json"),await fetch("https://jpdb.io/api/v1/"+i,{headers:a,method:"POST",body:JSON.stringify(n)})}async function oi(i,n){const o=await(await an("deck/list-vocabulary",{id:n.id,fetch_occurences:!0},i)).json();let a=[];for(let c=0;c<o.vocabulary.length;c++){let f={vid:o.vocabulary[c][0],sid:o.vocabulary[c][1],occurences:o.occurences[c]};a.push(f)}return{vocabs:a,...n}}async function si(i,n){const o=n.map(f=>[f.vid,f.sid]),a=await(await an("lookup-vocabulary",{list:o,fields:["card_state","frequency_rank"]},i)).json();let c=[];for(let f=0;f<a.vocabulary_info.length;f++)c.push({state:a.vocabulary_info[f][0],frequency:a.vocabulary_info[f][1],...n[f]});return c}async function _o(i){return(await(await an("list-user-decks",{fields:["name","vocabulary_known_coverage","vocabulary_in_progress_coverage","is_built_in","id","word_count","vocabulary_count"]},i)).json()).decks.map(a=>{let[c,f,v,_,g,d,y]=a;return{name:c,id:g,known_coverage:f??0,learning_coverage:v??0,is_built_in:_,word_count:d,vocab_count:y}})}function pr(i,n){const o=new Map;for(const a of i)for(const c of a){const f=`${c.vid},${c.sid}`,v=o.get(f);v!=null?(v.occurences+=c.occurences,v.decks+=1):o.set(f,{decks:1,...c})}if(n>1){const a=[];for(const c of o.values())c.decks>=n&&a.push(c);return a}else return[...o.values()]}function bo(i){return["known","never-forget","due","failed","learning"].includes(i.state[0])||i.state[0]==="locked"&&i.state[1]==="due"||i.state[0]==="redundant"&&i.state[1]!=="suspended"||i.state[0]==="redundant"&&i.state[1]!=="locked"}function tn(i,n){const o=i.sort((v,_)=>_.occurences-v.occurences);let a=0,c=0,f=0;for(;a<o.length;){let v=o[a];a+=1,v.state[0]!=="blacklisted"&&(f+=v.occurences,bo(v)?c+=v.occurences:n>0&&(n-=1,c+=v.occurences))}return 100*(c/f)}function zi(i,n,o){const a=i.slice();return a[31]=n[o],a}function Ui(i,n,o){const a=i.slice();return a[34]=n[o],a}function Wi(i){let n,o=i[34].name+"",a;return{c(){n=B("p"),a=ne(o)},m(c,f){Q(c,n,f),w(n,a)},p(c,f){f[0]&2048&&o!==(o=c[34].name+"")&&Te(a,o)},d(c){c&&G(n)}}}function Yi(i){let n,o,a,c,f;return{c(){n=B("p"),o=ne(`min decks:
                `),a=B("input"),re(a,"type","number")},m(v,_){Q(v,n,_),w(n,o),w(n,a),Ve(a,i[2]),c||(f=De(a,"input",i[23]),c=!0)},p(v,_){_[0]&4&&ct(a.value)!==v[2]&&Ve(a,v[2])},d(v){v&&G(n),c=!1,f()}}}function Vi(i){let n,o,a,c=Ct(i[13]),f=[];for(let v=0;v<c.length;v+=1)f[v]=Gi(zi(i,c,v));return{c(){n=B("select");for(let v=0;v<f.length;v+=1)f[v].c();i[6]===void 0&&mr(()=>i[25].call(n))},m(v,_){Q(v,n,_);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(n,null);Mi(n,i[6],!0),o||(a=De(n,"change",i[25]),o=!0)},p(v,_){if(_[0]&8192){c=Ct(v[13]);let g;for(g=0;g<c.length;g+=1){const d=zi(v,c,g);f[g]?f[g].p(d,_):(f[g]=Gi(d),f[g].c(),f[g].m(n,null))}for(;g<f.length;g+=1)f[g].d(1);f.length=c.length}_[0]&8256&&Mi(n,v[6])},d(v){v&&G(n),Sn(f,v),o=!1,a()}}}function Gi(i){let n,o=i[31]+"",a,c;return{c(){n=B("option"),a=ne(o),c=Y(),n.__value=i[31],Ve(n,n.__value)},m(f,v){Q(f,n,v),w(n,a),w(n,c)},p:Ie,d(f){f&&G(n)}}}function Ji(i){let n,o,a,c,f,v,_,g,d;return{c(){n=B("p"),o=ne("min: "),a=B("input"),c=Y(),f=B("p"),v=ne("max: "),_=B("input"),re(a,"type","number"),re(_,"type","number")},m(y,p){Q(y,n,p),w(n,o),w(n,a),Ve(a,i[8]),Q(y,c,p),Q(y,f,p),w(f,v),w(f,_),Ve(_,i[9]),g||(d=[De(a,"input",i[27]),De(_,"input",i[28])],g=!0)},p(y,p){p[0]&256&&ct(a.value)!==y[8]&&Ve(a,y[8]),p[0]&512&&ct(_.value)!==y[9]&&Ve(_,y[9])},d(y){y&&(G(n),G(c),G(f)),g=!1,wt(d)}}}function Qi(i){let n,o,a=i[4].name+"",c,f,v,_,g;return{c(){n=B("p"),o=ne(`Last created:
                `),c=ne(a),f=Y(),v=B("a"),_=ne("[jpdb]"),re(v,"target","_blank"),re(v,"href",g="https://jpdb.io/deck?id="+i[4].id)},m(d,y){Q(d,n,y),w(n,o),w(n,c),w(n,f),w(n,v),w(v,_)},p(d,y){y[0]&16&&a!==(a=d[4].name+"")&&Te(c,a),y[0]&16&&g!==(g="https://jpdb.io/deck?id="+d[4].id)&&re(v,"href",g)},d(d){d&&G(n)}}}function Bs(i){let n,o,a,c,f,v,_,g,d,y,p,E,I,N,T,H,W,ee,V,X,oe,K,R,F,ve,Pe,_e,Ke,$e,Me,be,Fe,qe,me,pe,ue,ge,J,ce,et,Le,Be,tt,ft,fe,Je,at,ye=Ct(i[11]),z=[];for(let ke=0;ke<ye.length;ke+=1)z[ke]=Wi(Ui(i,ye,ke));let ae=i[3]==i[12].BijakMerge&&Yi(i),Ae=i[5]&&Vi(i),nt=i[7]&&Ji(i),rt=i[4]!=null&&Qi(i);return fe=rs(i[20][0]),{c(){n=B("div"),o=B("h3"),o.textContent="Deckmerger",a=ne(`
        selected decks:`),c=B("br"),f=Y();for(let ke=0;ke<z.length;ke+=1)z[ke].c();v=Y(),_=B("button"),_.textContent="Reset selection",g=Y(),d=B("p"),y=ne(`Name of new deck
            `),p=B("input"),E=Y(),I=B("p"),N=ne(`min occurences:
            `),T=B("input"),H=Y(),W=B("p"),ee=B("label"),V=B("input"),X=ne(`
                Merge`),oe=Y(),K=B("label"),R=B("input"),F=ne(`
                Intersect`),ve=Y(),Pe=B("label"),_e=B("input"),Ke=ne(`
                BijakMerge`),$e=Y(),ae&&ae.c(),Me=Y(),be=B("p"),Fe=ne(`Filter for card state?
            `),qe=B("input"),me=Y(),Ae&&Ae.c(),pe=Y(),ue=B("p"),ge=ne(`Filter by global frequency?
            `),J=B("input"),ce=Y(),nt&&nt.c(),et=Y(),Le=B("button"),Be=ne("create deck"),ft=Y(),rt&&rt.c(),re(p,"type","text"),re(T,"type","number"),re(V,"type","radio"),re(V,"name","strat"),V.__value=i[12].Merge,Ve(V,V.__value),re(ee,"title","Merges decks into new deck, adds up all vocab occurences, then removes all vocab where occurences < min_occurences"),re(R,"type","radio"),re(R,"name","strat"),R.__value=i[12].Intersect,Ve(R,R.__value),re(K,"title","Only adds those words into the new deck that appear in all decks. Then removes all where occurences < min_occurences"),re(_e,"type","radio"),re(_e,"name","strat"),_e.__value=i[12].BijakMerge,Ve(_e,_e.__value),re(Pe,"title","The BijakMerge (named after its inventor) works just like the regular merge, but also needs a minimum number of decks for a word to appear in for it to be included."),re(qe,"type","checkbox"),re(J,"type","checkbox"),Le.disabled=tt=i[11].length<=0,re(n,"id","deckmerger_div"),fe.p(V,R,_e)},m(ke,Qe){Q(ke,n,Qe),w(n,o),w(n,a),w(n,c),w(n,f);for(let He=0;He<z.length;He+=1)z[He]&&z[He].m(n,null);w(n,v),w(n,_),w(n,g),w(n,d),w(d,y),w(d,p),Ve(p,i[0]),w(n,E),w(n,I),w(I,N),w(I,T),Ve(T,i[1]),w(n,H),w(n,W),w(W,ee),w(ee,V),V.checked=V.__value===i[3],w(ee,X),w(W,oe),w(W,K),w(K,R),R.checked=R.__value===i[3],w(K,F),w(W,ve),w(W,Pe),w(Pe,_e),_e.checked=_e.__value===i[3],w(Pe,Ke),w(n,$e),ae&&ae.m(n,null),w(n,Me),w(n,be),w(be,Fe),w(be,qe),qe.checked=i[5],w(be,me),Ae&&Ae.m(be,null),w(n,pe),w(n,ue),w(ue,ge),w(ue,J),J.checked=i[7],w(ue,ce),nt&&nt.m(ue,null),w(n,et),w(n,Le),w(Le,Be),w(n,ft),rt&&rt.m(n,null),Je||(at=[De(_,"click",i[16]),De(p,"input",i[17]),De(T,"input",i[18]),De(V,"change",i[19]),De(R,"change",i[21]),De(_e,"change",i[22]),De(qe,"change",i[24]),De(J,"change",i[26]),De(Le,"click",i[29])],Je=!0)},p(ke,Qe){if(Qe[0]&2048){ye=Ct(ke[11]);let He;for(He=0;He<ye.length;He+=1){const ht=Ui(ke,ye,He);z[He]?z[He].p(ht,Qe):(z[He]=Wi(ht),z[He].c(),z[He].m(n,v))}for(;He<z.length;He+=1)z[He].d(1);z.length=ye.length}Qe[0]&1&&p.value!==ke[0]&&Ve(p,ke[0]),Qe[0]&2&&ct(T.value)!==ke[1]&&Ve(T,ke[1]),Qe[0]&8&&(V.checked=V.__value===ke[3]),Qe[0]&8&&(R.checked=R.__value===ke[3]),Qe[0]&8&&(_e.checked=_e.__value===ke[3]),ke[3]==ke[12].BijakMerge?ae?ae.p(ke,Qe):(ae=Yi(ke),ae.c(),ae.m(n,Me)):ae&&(ae.d(1),ae=null),Qe[0]&32&&(qe.checked=ke[5]),ke[5]?Ae?Ae.p(ke,Qe):(Ae=Vi(ke),Ae.c(),Ae.m(be,null)):Ae&&(Ae.d(1),Ae=null),Qe[0]&128&&(J.checked=ke[7]),ke[7]?nt?nt.p(ke,Qe):(nt=Ji(ke),nt.c(),nt.m(ue,null)):nt&&(nt.d(1),nt=null),Qe[0]&2048&&tt!==(tt=ke[11].length<=0)&&(Le.disabled=tt),ke[4]!=null?rt?rt.p(ke,Qe):(rt=Qi(ke),rt.c(),rt.m(n,null)):rt&&(rt.d(1),rt=null)},i:Ie,o:Ie,d(ke){ke&&G(n),Sn(z,ke),ae&&ae.d(),Ae&&Ae.d(),nt&&nt.d(),rt&&rt.d(),fe.r(),Je=!1,wt(at)}}}function Ms(i,n,o){let a,c,f;st(i,sn,me=>o(10,a=me)),st(i,zt,me=>o(30,c=me)),st(i,gt,me=>o(11,f=me));var v=(me=>(me[me.Merge=0]="Merge",me[me.Intersect=1]="Intersect",me[me.BijakMerge=2]="BijakMerge",me))(v||{});let _="",g=1,d=1,y=0,p=null,E=!1,I=["new","locked","learning","known","due","failed","never-forget","suspended","blacklisted"],N=I[0],T=!1,H=1,W=3e4;async function ee(me,pe){let ue=[],ge=[];pe.forEach(ce=>{ue.push([ce.vid,ce.sid]),ge.push(ce.occurences)});const J=await(await an("deck/add-vocabulary",{id:me,vocabulary:ue,occurences:ge},a)).json();bt(zt,c=JSON.stringify(J),c)}async function V(me){return(await(await an("deck/create-empty",{name:me},a)).json()).id}const X=[[]],oe=()=>{bt(gt,f=[],f)};function K(){_=this.value,o(0,_)}function R(){g=ct(this.value),o(1,g)}function F(){y=this.__value,o(3,y)}function ve(){y=this.__value,o(3,y)}function Pe(){y=this.__value,o(3,y)}function _e(){d=ct(this.value),o(2,d)}function Ke(){E=this.checked,o(5,E)}function $e(){N=os(this),o(6,N),o(13,I)}function Me(){T=this.checked,o(7,T)}function be(){H=ct(this.value),o(8,H)}function Fe(){W=ct(this.value),o(9,W)}return[_,g,d,y,p,E,N,T,H,W,a,f,v,I,ee,V,oe,K,R,F,X,ve,Pe,_e,Ke,$e,Me,be,Fe,async()=>{if(_!==""){o(4,p=null);const me=[];for(const ge of f){const J=await oi(a,ge);me.push(J.vocabs)}let pe;switch(y){case v.Merge:pe=pr(me,1);break;case v.Intersect:pe=pr(me,me.length);break;case v.BijakMerge:pe=pr(me,d);break}pe=pe.filter(ge=>ge.occurences>=g),(E||T)&&(pe=await si(a,pe),E&&(pe=pe.filter(ge=>ge.state[0]===N)),T&&(pe=pe.filter(ge=>H<=ge.frequency&&ge.frequency<=W)));const ue=await V(_);await ee(ue,pe),o(4,p={id:ue,name:_})}}]}class Fs extends At{constructor(n){super(),xt(this,n,Ms,Bs,Pt,{},null,[-1,-1])}}function Xi(i,n,o){const a=i.slice();return a[7]=n[o],a}function Zi(i){let n,o=i[7].name+"",a;return{c(){n=B("p"),a=ne(o)},m(c,f){Q(c,n,f),w(n,a)},p(c,f){f&1&&o!==(o=c[7].name+"")&&Te(a,o)},d(c){c&&G(n)}}}function Is(i){let n,o,a,c,f,v,_,g,d,y,p,E,I,N,T,H,W,ee=Ct(i[0]),V=[];for(let X=0;X<ee.length;X+=1)V[X]=Zi(Xi(i,ee,X));return{c(){n=B("div"),o=B("h3"),o.textContent="DeckYeeter",a=Y(),c=B("p"),c.textContent="Decks to delete:",f=Y();for(let X=0;X<V.length;X+=1)V[X].c();v=Y(),_=B("button"),_.textContent="Reset selection",g=Y(),d=B("br"),y=Y(),p=B("br"),E=Y(),I=B("br"),N=Y(),T=B("button"),T.textContent="Delete Decks!"},m(X,oe){Q(X,n,oe),w(n,o),w(n,a),w(n,c),w(n,f);for(let K=0;K<V.length;K+=1)V[K]&&V[K].m(n,null);w(n,v),w(n,_),w(n,g),w(n,d),w(n,y),w(n,p),w(n,E),w(n,I),w(n,N),w(n,T),H||(W=[De(_,"click",i[3]),De(T,"click",i[4])],H=!0)},p(X,[oe]){if(oe&1){ee=Ct(X[0]);let K;for(K=0;K<ee.length;K+=1){const R=Xi(X,ee,K);V[K]?V[K].p(R,oe):(V[K]=Zi(R),V[K].c(),V[K].m(n,v))}for(;K<V.length;K+=1)V[K].d(1);V.length=ee.length}},i:Ie,o:Ie,d(X){X&&G(n),Sn(V,X),H=!1,wt(W)}}}function Ns(i,n,o){let a,c,f;st(i,zt,y=>o(5,a=y)),st(i,sn,y=>o(6,c=y)),st(i,gt,y=>o(0,f=y));const v=vo();async function _(y){const p=await(await an("deck/delete",{id:y.id},c)).json();bt(zt,a=JSON.stringify(p),a)}return[f,v,_,()=>{bt(gt,f=[],f)},async()=>{if(confirm("I'll delete "+f.length+" decks. Is that ok?")){for(const p of f)await _(p);bt(gt,f=[],f),v("deleted_decks")}}]}class Ls extends At{constructor(n){super(),xt(this,n,Ns,Is,Pt,{})}}function Hs(i){let n,o,a,c,f,v,_,g,d;return{c(){n=B("p"),n.innerHTML='Put your API Token here (from the bottom of <a target="_blank" href="https://jpdb.io/settings">jpdb.io/settings</a>), it won&#39;t get sent anywhere except jpdb.io. Don&#39;t share it with anyone!',o=Y(),a=B("p"),a.textContent=`You can enter the token in your browsers password manager if you don't want
    to input it every time you use this site.`,c=Y(),f=B("input"),v=Y(),_=B("button"),_.textContent="Confirm",re(f,"type","password"),re(_,"type","button")},m(y,p){Q(y,n,p),Q(y,o,p),Q(y,a,p),Q(y,c,p),Q(y,f,p),Ve(f,i[0]),Q(y,v,p),Q(y,_,p),g||(d=[De(f,"input",i[2]),De(_,"click",i[1])],g=!0)},p(y,[p]){p&1&&f.value!==y[0]&&Ve(f,y[0])},i:Ie,o:Ie,d(y){y&&(G(n),G(o),G(a),G(c),G(f),G(v),G(_)),g=!1,wt(d)}}}function zs(i,n,o){let a,c,f;st(i,ti,d=>o(3,a=d)),st(i,zt,d=>o(4,c=d)),st(i,sn,d=>o(0,f=d));const v=vo();async function _(){const y=await(await an("ping",{},f)).json();bt(zt,c=JSON.stringify(y),c),c=="{}"&&(bt(zt,c="Token confirmed as correct.",c),bt(ti,a=!0,a),v("login"))}function g(){f=this.value,sn.set(f)}return[f,_,g]}class Us extends At{constructor(n){super(),xt(this,n,zs,Hs,Pt,{})}}function eo(i,n,o){const a=i.slice();return a[6]=n[o],a}function to(i){var Fe,qe,me,pe;let n,o,a,c,f,v=((Fe=i[0])==null?void 0:Fe.name)+"",_,g,d,y,p,E,I=((qe=i[0])==null?void 0:qe.word_count)+"",N,T,H,W,ee,V,X=((me=i[0])==null?void 0:me.known_coverage.toFixed(2))+"",oe,K,R,F,ve,Pe,_e=((pe=i[0])==null?void 0:pe.learning_coverage.toFixed(2))+"",Ke,$e,Me=Ct(i[1]),be=[];for(let ue=0;ue<Me.length;ue+=1)be[ue]=no(eo(i,Me,ue));return{c(){n=B("table"),o=B("tr"),a=B("td"),a.textContent="Deck name",c=Y(),f=B("td"),_=ne(v),g=Y(),d=B("tr"),y=B("td"),y.textContent="WordCount",p=Y(),E=B("td"),N=ne(I),T=Y(),H=B("tr"),W=B("td"),W.textContent="known coverage",ee=Y(),V=B("td"),oe=ne(X),K=Y(),R=B("tr"),F=B("td"),F.textContent="learning coverage",ve=Y(),Pe=B("td"),Ke=ne(_e),$e=Y();for(let ue=0;ue<be.length;ue+=1)be[ue].c();re(a,"class","svelte-1drq2p9"),re(f,"class","svelte-1drq2p9"),re(o,"class","svelte-1drq2p9"),re(y,"class","svelte-1drq2p9"),re(E,"class","svelte-1drq2p9"),re(d,"class","svelte-1drq2p9"),re(W,"class","svelte-1drq2p9"),re(V,"class","svelte-1drq2p9"),re(H,"class","svelte-1drq2p9"),re(F,"class","svelte-1drq2p9"),re(Pe,"class","svelte-1drq2p9"),re(R,"class","svelte-1drq2p9"),re(n,"class","svelte-1drq2p9")},m(ue,ge){Q(ue,n,ge),w(n,o),w(o,a),w(o,c),w(o,f),w(f,_),w(n,g),w(n,d),w(d,y),w(d,p),w(d,E),w(E,N),w(n,T),w(n,H),w(H,W),w(H,ee),w(H,V),w(V,oe),w(n,K),w(n,R),w(R,F),w(R,ve),w(R,Pe),w(Pe,Ke),w(n,$e);for(let J=0;J<be.length;J+=1)be[J]&&be[J].m(n,null)},p(ue,ge){var J,ce,et,Le;if(ge&1&&v!==(v=((J=ue[0])==null?void 0:J.name)+"")&&Te(_,v),ge&1&&I!==(I=((ce=ue[0])==null?void 0:ce.word_count)+"")&&Te(N,I),ge&1&&X!==(X=((et=ue[0])==null?void 0:et.known_coverage.toFixed(2))+"")&&Te(oe,X),ge&1&&_e!==(_e=((Le=ue[0])==null?void 0:Le.learning_coverage.toFixed(2))+"")&&Te(Ke,_e),ge&2){Me=Ct(ue[1]);let Be;for(Be=0;Be<Me.length;Be+=1){const tt=eo(ue,Me,Be);be[Be]?be[Be].p(tt,ge):(be[Be]=no(tt),be[Be].c(),be[Be].m(n,null))}for(;Be<be.length;Be+=1)be[Be].d(1);be.length=Me.length}},d(ue){ue&&G(n),Sn(be,ue)}}}function no(i){let n,o,a,c=i[6][0]+"",f,v,_,g,d=i[6][1].toFixed(2)+"",y,p;return{c(){n=B("tr"),o=B("td"),a=ne("learning coverage with "),f=ne(c),v=ne(" extra learned"),_=Y(),g=B("td"),y=ne(d),p=Y(),re(o,"class","svelte-1drq2p9"),re(g,"class","svelte-1drq2p9"),re(n,"class","svelte-1drq2p9")},m(E,I){Q(E,n,I),w(n,o),w(o,a),w(o,f),w(o,v),w(n,_),w(n,g),w(g,y),w(n,p)},p(E,I){I&2&&c!==(c=E[6][0]+"")&&Te(f,c),I&2&&d!==(d=E[6][1].toFixed(2)+"")&&Te(y,d)},d(E){E&&G(n)}}}function Ws(i){let n,o,a,c,f,v,_,g,d,y=i[0]!==void 0&&to(i);return{c(){n=B("div"),o=B("h3"),o.textContent="Deck coverage prediction for a single deck",a=Y(),c=B("p"),c.textContent=`This tool predicts how coverage for a deck will change if you learned
        new vocab in local frequency order.`,f=Y(),v=B("p"),v.textContent="It considers new, locked and suspended cards as learnable.",_=Y(),g=B("p"),g.textContent="Select a deck from the deck list to the left.",d=Y(),y&&y.c()},m(p,E){Q(p,n,E),w(n,o),w(n,a),w(n,c),w(n,f),w(n,v),w(n,_),w(n,g),w(n,d),y&&y.m(n,null)},p(p,[E]){p[0]!==void 0?y?y.p(p,E):(y=to(p),y.c(),y.m(n,null)):y&&(y.d(1),y=null)},i:Ie,o:Ie,d(p){p&&G(n),y&&y.d()}}}function Ys(i,n,o){let a,c;st(i,sn,d=>o(4,a=d)),st(i,gt,d=>o(2,c=d));let f,v=[],_=0;async function g(d){const y=await oi(a,d);let p=await si(a,y.vocabs),E=[],I=[50,100,200,400,600,800,1e3,1500,2e3,4e3,6e3,8e3,1e4,2e4,1e5];_=p.filter(T=>T.state[0]!="blacklisted").filter(T=>!bo(T)).length;for(let T of I){let H=Math.min(T,_),W=tn(p,H);if(E.push([H,W]),H>=_)break}o(1,v=E),o(0,f=y)}return i.$$.update=()=>{if(i.$$.dirty&4&&c.length>0){let d=c[c.length-1];g(d)}},[f,v,c]}class Vs extends At{constructor(n){super(),xt(this,n,Ys,Ws,Pt,{})}}var ro=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gs(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ai={exports:{}};ai.exports;(function(i){var n=function(){var o=String.fromCharCode,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",f={};function v(g,d){if(!f[g]){f[g]={};for(var y=0;y<g.length;y++)f[g][g.charAt(y)]=y}return f[g][d]}var _={compressToBase64:function(g){if(g==null)return"";var d=_._compress(g,6,function(y){return a.charAt(y)});switch(d.length%4){default:case 0:return d;case 1:return d+"===";case 2:return d+"==";case 3:return d+"="}},decompressFromBase64:function(g){return g==null?"":g==""?null:_._decompress(g.length,32,function(d){return v(a,g.charAt(d))})},compressToUTF16:function(g){return g==null?"":_._compress(g,15,function(d){return o(d+32)})+" "},decompressFromUTF16:function(g){return g==null?"":g==""?null:_._decompress(g.length,16384,function(d){return g.charCodeAt(d)-32})},compressToUint8Array:function(g){for(var d=_.compress(g),y=new Uint8Array(d.length*2),p=0,E=d.length;p<E;p++){var I=d.charCodeAt(p);y[p*2]=I>>>8,y[p*2+1]=I%256}return y},decompressFromUint8Array:function(g){if(g==null)return _.decompress(g);for(var d=new Array(g.length/2),y=0,p=d.length;y<p;y++)d[y]=g[y*2]*256+g[y*2+1];var E=[];return d.forEach(function(I){E.push(o(I))}),_.decompress(E.join(""))},compressToEncodedURIComponent:function(g){return g==null?"":_._compress(g,6,function(d){return c.charAt(d)})},decompressFromEncodedURIComponent:function(g){return g==null?"":g==""?null:(g=g.replace(/ /g,"+"),_._decompress(g.length,32,function(d){return v(c,g.charAt(d))}))},compress:function(g){return _._compress(g,16,function(d){return o(d)})},_compress:function(g,d,y){if(g==null)return"";var p,E,I={},N={},T="",H="",W="",ee=2,V=3,X=2,oe=[],K=0,R=0,F;for(F=0;F<g.length;F+=1)if(T=g.charAt(F),Object.prototype.hasOwnProperty.call(I,T)||(I[T]=V++,N[T]=!0),H=W+T,Object.prototype.hasOwnProperty.call(I,H))W=H;else{if(Object.prototype.hasOwnProperty.call(N,W)){if(W.charCodeAt(0)<256){for(p=0;p<X;p++)K=K<<1,R==d-1?(R=0,oe.push(y(K)),K=0):R++;for(E=W.charCodeAt(0),p=0;p<8;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1}else{for(E=1,p=0;p<X;p++)K=K<<1|E,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=0;for(E=W.charCodeAt(0),p=0;p<16;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1}ee--,ee==0&&(ee=Math.pow(2,X),X++),delete N[W]}else for(E=I[W],p=0;p<X;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1;ee--,ee==0&&(ee=Math.pow(2,X),X++),I[H]=V++,W=String(T)}if(W!==""){if(Object.prototype.hasOwnProperty.call(N,W)){if(W.charCodeAt(0)<256){for(p=0;p<X;p++)K=K<<1,R==d-1?(R=0,oe.push(y(K)),K=0):R++;for(E=W.charCodeAt(0),p=0;p<8;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1}else{for(E=1,p=0;p<X;p++)K=K<<1|E,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=0;for(E=W.charCodeAt(0),p=0;p<16;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1}ee--,ee==0&&(ee=Math.pow(2,X),X++),delete N[W]}else for(E=I[W],p=0;p<X;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1;ee--,ee==0&&(ee=Math.pow(2,X),X++)}for(E=2,p=0;p<X;p++)K=K<<1|E&1,R==d-1?(R=0,oe.push(y(K)),K=0):R++,E=E>>1;for(;;)if(K=K<<1,R==d-1){oe.push(y(K));break}else R++;return oe.join("")},decompress:function(g){return g==null?"":g==""?null:_._decompress(g.length,32768,function(d){return g.charCodeAt(d)})},_decompress:function(g,d,y){var p=[],E=4,I=4,N=3,T="",H=[],W,ee,V,X,oe,K,R,F={val:y(0),position:d,index:1};for(W=0;W<3;W+=1)p[W]=W;for(V=0,oe=Math.pow(2,2),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;switch(V){case 0:for(V=0,oe=Math.pow(2,8),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;R=o(V);break;case 1:for(V=0,oe=Math.pow(2,16),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;R=o(V);break;case 2:return""}for(p[3]=R,ee=R,H.push(R);;){if(F.index>g)return"";for(V=0,oe=Math.pow(2,N),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;switch(R=V){case 0:for(V=0,oe=Math.pow(2,8),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;p[I++]=o(V),R=I-1,E--;break;case 1:for(V=0,oe=Math.pow(2,16),K=1;K!=oe;)X=F.val&F.position,F.position>>=1,F.position==0&&(F.position=d,F.val=y(F.index++)),V|=(X>0?1:0)*K,K<<=1;p[I++]=o(V),R=I-1,E--;break;case 2:return H.join("")}if(E==0&&(E=Math.pow(2,N),N++),p[R])T=p[R];else if(R===I)T=ee+ee.charAt(0);else return null;H.push(T),p[I++]=ee+T.charAt(0),E--,ee=T,E==0&&(E=Math.pow(2,N),N++)}}};return _}();i!=null?i.exports=n:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return n})})(ai);var io=ai.exports;function oo(i,n,o){const a=i.slice();return a[11]=n[o],a}function Js(i){let n;return{c(){n=ne("Name")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Qs(i){let n;return{c(){n=ne("Vocab")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Xs(i){let n;return{c(){n=ne("Words")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function Zs(i){let n;return{c(){n=ne("Coverage")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function ea(i){let n,o,a;return{c(){n=ne("Learning"),o=B("br"),a=ne("Coverage")},m(c,f){Q(c,n,f),Q(c,o,f),Q(c,a,f)},p:Ie,d(c){c&&(G(n),G(o),G(a))}}}function ta(i){let n;return{c(){n=ne("LC + 50")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function na(i){let n;return{c(){n=ne("LC + 100")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function ra(i){let n,o;return{c(){n=ne("LC + "),o=ne(i[1])},m(a,c){Q(a,n,c),Q(a,o,c)},p(a,c){c&2&&Te(o,a[1])},d(a){a&&(G(n),G(o))}}}function ia(i){let n;return{c(){n=ne("Cliff")},m(o,a){Q(o,n,a)},d(o){o&&G(n)}}}function so(i){let n,o,a=i[11].name+"",c,f,v,_=i[11].vocab_count+"",g,d,y,p=i[11].word_count+"",E,I,N,T=i[11].known_coverage.toFixed(2)+"",H,W,ee,V=i[11].learning_coverage.toFixed(2)+"",X,oe,K,R=i[11].lc_50.toFixed(2)+"",F,ve,Pe,_e=i[11].lc_100.toFixed(2)+"",Ke,$e,Me,be=i[11].lc_custom.toFixed(2)+"",Fe,qe,me,pe=i[11].cliff.toFixed(2)+"",ue,ge;return{c(){n=B("tr"),o=B("td"),c=ne(a),f=Y(),v=B("td"),g=ne(_),d=Y(),y=B("td"),E=ne(p),I=Y(),N=B("td"),H=ne(T),W=Y(),ee=B("td"),X=ne(V),oe=Y(),K=B("td"),F=ne(R),ve=Y(),Pe=B("td"),Ke=ne(_e),$e=Y(),Me=B("td"),Fe=ne(be),qe=Y(),me=B("td"),ue=ne(pe),ge=Y(),re(o,"class","svelte-1unx20t"),re(v,"class","svelte-1unx20t"),re(y,"class","svelte-1unx20t"),re(N,"class","svelte-1unx20t"),re(ee,"class","svelte-1unx20t"),re(K,"class","svelte-1unx20t"),re(Pe,"class","svelte-1unx20t"),re(Me,"class","svelte-1unx20t"),re(me,"class","svelte-1unx20t"),re(n,"class","svelte-1unx20t")},m(J,ce){Q(J,n,ce),w(n,o),w(o,c),w(n,f),w(n,v),w(v,g),w(n,d),w(n,y),w(y,E),w(n,I),w(n,N),w(N,H),w(n,W),w(n,ee),w(ee,X),w(n,oe),w(n,K),w(K,F),w(n,ve),w(n,Pe),w(Pe,Ke),w(n,$e),w(n,Me),w(Me,Fe),w(n,qe),w(n,me),w(me,ue),w(n,ge)},p(J,ce){ce&16&&a!==(a=J[11].name+"")&&Te(c,a),ce&16&&_!==(_=J[11].vocab_count+"")&&Te(g,_),ce&16&&p!==(p=J[11].word_count+"")&&Te(E,p),ce&16&&T!==(T=J[11].known_coverage.toFixed(2)+"")&&Te(H,T),ce&16&&V!==(V=J[11].learning_coverage.toFixed(2)+"")&&Te(X,V),ce&16&&R!==(R=J[11].lc_50.toFixed(2)+"")&&Te(F,R),ce&16&&_e!==(_e=J[11].lc_100.toFixed(2)+"")&&Te(Ke,_e),ce&16&&be!==(be=J[11].lc_custom.toFixed(2)+"")&&Te(Fe,be),ce&16&&pe!==(pe=J[11].cliff.toFixed(2)+"")&&Te(ue,pe)},d(J){J&&G(n)}}}function oa(i){let n,o,a,c,f,v,_,g,d,y,p,E,I,N,T,H,W,ee,V,X,oe,K,R,F,ve,Pe,_e,Ke,$e,Me,be,Fe,qe,me,pe,ue,ge,J,ce,et,Le,Be,tt,ft,fe,Je;ve=new mt({props:{handler:i[2],orderBy:"name",$$slots:{default:[Js]},$$scope:{ctx:i}}}),_e=new mt({props:{handler:i[2],orderBy:"vocab_count",$$slots:{default:[Qs]},$$scope:{ctx:i}}}),$e=new mt({props:{handler:i[2],orderBy:"word_count",$$slots:{default:[Xs]},$$scope:{ctx:i}}}),be=new mt({props:{handler:i[2],orderBy:"known_coverage",$$slots:{default:[Zs]},$$scope:{ctx:i}}}),qe=new mt({props:{handler:i[2],orderBy:"learning_coverage",$$slots:{default:[ea]},$$scope:{ctx:i}}}),pe=new mt({props:{handler:i[2],orderBy:"lc_50",$$slots:{default:[ta]},$$scope:{ctx:i}}}),ge=new mt({props:{handler:i[2],orderBy:"lc_100",$$slots:{default:[na]},$$scope:{ctx:i}}}),ce=new mt({props:{handler:i[2],orderBy:"lc_custom",$$slots:{default:[ra]},$$scope:{ctx:i}}}),Le=new mt({props:{handler:i[2],orderBy:"cliff",$$slots:{default:[ia]},$$scope:{ctx:i}}});let at=Ct(i[4]),ye=[];for(let z=0;z<at.length;z+=1)ye[z]=so(oo(i,at,z));return{c(){n=B("br"),o=Y(),a=B("br"),c=ne(`
Min coverage (LC+`),f=ne(i[1]),v=ne(`):
`),_=B("input"),g=ne(`

Custom learnahead:
`),d=B("input"),y=Y(),p=B("p"),p.textContent="Explanation:",E=Y(),I=B("p"),I.textContent=`LC + 50 etc: learning coverage if you learned 50 additional vocab in local
    frequency order`,N=Y(),T=B("p"),H=ne("Cliff: LC+"),W=ne(i[1]),ee=ne(" - learning coverge"),V=Y(),X=B("p"),X.textContent="The greater the cliff is the more that media will hammer in new vocab.",oe=Y(),K=B("table"),R=B("thead"),F=B("tr"),Ge(ve.$$.fragment),Pe=Y(),Ge(_e.$$.fragment),Ke=Y(),Ge($e.$$.fragment),Me=Y(),Ge(be.$$.fragment),Fe=Y(),Ge(qe.$$.fragment),me=Y(),Ge(pe.$$.fragment),ue=Y(),Ge(ge.$$.fragment),J=Y(),Ge(ce.$$.fragment),et=Y(),Ge(Le.$$.fragment),Be=Y(),tt=B("tbody");for(let z=0;z<ye.length;z+=1)ye[z].c();re(_,"type","number"),re(d,"type","number"),re(F,"class","svelte-1unx20t"),re(K,"class","svelte-1unx20t")},m(z,ae){Q(z,n,ae),Q(z,o,ae),Q(z,a,ae),Q(z,c,ae),Q(z,f,ae),Q(z,v,ae),Q(z,_,ae),Ve(_,i[0]),Q(z,g,ae),Q(z,d,ae),Ve(d,i[1]),Q(z,y,ae),Q(z,p,ae),Q(z,E,ae),Q(z,I,ae),Q(z,N,ae),Q(z,T,ae),w(T,H),w(T,W),w(T,ee),Q(z,V,ae),Q(z,X,ae),Q(z,oe,ae),Q(z,K,ae),w(K,R),w(R,F),We(ve,F,null),w(F,Pe),We(_e,F,null),w(F,Ke),We($e,F,null),w(F,Me),We(be,F,null),w(F,Fe),We(qe,F,null),w(F,me),We(pe,F,null),w(F,ue),We(ge,F,null),w(F,J),We(ce,F,null),w(F,et),We(Le,F,null),w(K,Be),w(K,tt);for(let Ae=0;Ae<ye.length;Ae+=1)ye[Ae]&&ye[Ae].m(tt,null);ft=!0,fe||(Je=[De(_,"input",i[8]),De(_,"input",i[9]),De(d,"input",i[10])],fe=!0)},p(z,[ae]){(!ft||ae&2)&&Te(f,z[1]),ae&1&&ct(_.value)!==z[0]&&Ve(_,z[0]),ae&2&&ct(d.value)!==z[1]&&Ve(d,z[1]),(!ft||ae&2)&&Te(W,z[1]);const Ae={};ae&4&&(Ae.handler=z[2]),ae&16384&&(Ae.$$scope={dirty:ae,ctx:z}),ve.$set(Ae);const nt={};ae&4&&(nt.handler=z[2]),ae&16384&&(nt.$$scope={dirty:ae,ctx:z}),_e.$set(nt);const rt={};ae&4&&(rt.handler=z[2]),ae&16384&&(rt.$$scope={dirty:ae,ctx:z}),$e.$set(rt);const ke={};ae&4&&(ke.handler=z[2]),ae&16384&&(ke.$$scope={dirty:ae,ctx:z}),be.$set(ke);const Qe={};ae&4&&(Qe.handler=z[2]),ae&16384&&(Qe.$$scope={dirty:ae,ctx:z}),qe.$set(Qe);const He={};ae&4&&(He.handler=z[2]),ae&16384&&(He.$$scope={dirty:ae,ctx:z}),pe.$set(He);const ht={};ae&4&&(ht.handler=z[2]),ae&16384&&(ht.$$scope={dirty:ae,ctx:z}),ge.$set(ht);const un={};ae&4&&(un.handler=z[2]),ae&16386&&(un.$$scope={dirty:ae,ctx:z}),ce.$set(un);const Rt={};if(ae&4&&(Rt.handler=z[2]),ae&16384&&(Rt.$$scope={dirty:ae,ctx:z}),Le.$set(Rt),ae&16){at=Ct(z[4]);let dt;for(dt=0;dt<at.length;dt+=1){const qt=oo(z,at,dt);ye[dt]?ye[dt].p(qt,ae):(ye[dt]=so(qt),ye[dt].c(),ye[dt].m(tt,null))}for(;dt<ye.length;dt+=1)ye[dt].d(1);ye.length=at.length}},i(z){ft||(Ce(ve.$$.fragment,z),Ce(_e.$$.fragment,z),Ce($e.$$.fragment,z),Ce(be.$$.fragment,z),Ce(qe.$$.fragment,z),Ce(pe.$$.fragment,z),Ce(ge.$$.fragment,z),Ce(ce.$$.fragment,z),Ce(Le.$$.fragment,z),ft=!0)},o(z){je(ve.$$.fragment,z),je(_e.$$.fragment,z),je($e.$$.fragment,z),je(be.$$.fragment,z),je(qe.$$.fragment,z),je(pe.$$.fragment,z),je(ge.$$.fragment,z),je(ce.$$.fragment,z),je(Le.$$.fragment,z),ft=!1},d(z){z&&(G(n),G(o),G(a),G(c),G(f),G(v),G(_),G(g),G(d),G(y),G(p),G(E),G(I),G(N),G(T),G(V),G(X),G(oe),G(K)),Ye(ve),Ye(_e),Ye($e),Ye(be),Ye(qe),Ye(pe),Ye(ge),Ye(ce),Ye(Le),Sn(ye,z),fe=!1,wt(Je)}}}function sa(i,n,o){let a,c=Ie,f=()=>(c(),c=On(E,H=>o(4,a=H)),E);i.$$.on_destroy.push(()=>c());let{decks:v}=n,{startTime:_}=n,g=0,d=200,y=v.map(H=>{let W=tn(H.vocabs,d);return{...H,lc_50:tn(H.vocabs,50),lc_100:tn(H.vocabs,100),lc_custom:W,cliff:W-H.learning_coverage}});console.log(`[${Date.now()-_}] Done with coverage prediction`);let p=new vr(y),E=p.getRows();f(),p.sortDesc("learning_coverage");function I(){g=ct(this.value),o(0,g)}const N=()=>p.filter(g,"lc_custom",(H,W)=>H>W);function T(){d=ct(this.value),o(1,d)}return i.$$set=H=>{"decks"in H&&o(5,v=H.decks),"startTime"in H&&o(6,_=H.startTime)},i.$$.update=()=>{i.$$.dirty&167&&d&&(console.log("recomputing custom learnahead coverage"),o(7,y=v.map(H=>{let W=tn(H.vocabs,d);return{...H,lc_50:tn(H.vocabs,50),lc_100:tn(H.vocabs,100),lc_custom:W,cliff:W-H.learning_coverage}})),o(2,p=new vr(y)),f(o(3,E=p.getRows())),p.sortDesc("lc_custom"),p.filter(g,"lc_custom",(H,W)=>H>W))},[g,d,p,E,a,v,_,y,I,N,T]}class aa extends At{constructor(n){super(),xt(this,n,sa,oa,Pt,{decks:5,startTime:6})}}var wo={exports:{}};(function(i,n){(function(o,a){i.exports=a()})(ro,function(){var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var u in s)Object.prototype.hasOwnProperty.call(s,u)&&(r[u]=s[u])})(e,t)},a=function(){return(a=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++)for(var u in t=arguments[r])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e}).apply(this,arguments)};function c(e,t,r){if(r||arguments.length===2)for(var s,u=0,l=t.length;u<l;u++)!s&&u in t||((s=s||Array.prototype.slice.call(t,0,u))[u]=t[u]);return e.concat(s||Array.prototype.slice.call(t))}var f=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ro,v=Object.keys,_=Array.isArray;function g(e,t){return typeof t!="object"||v(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||f.Promise||(f.Promise=Promise);var d=Object.getPrototypeOf,y={}.hasOwnProperty;function p(e,t){return y.call(e,t)}function E(e,t){typeof t=="function"&&(t=t(d(e))),(typeof Reflect>"u"?v:Reflect.ownKeys)(t).forEach(function(r){N(e,r,t[r])})}var I=Object.defineProperty;function N(e,t,r,s){I(e,t,g(r&&p(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},s))}function T(e){return{from:function(t){return e.prototype=Object.create(t.prototype),N(e.prototype,"constructor",e),{extend:E.bind(null,e.prototype)}}}}var H=Object.getOwnPropertyDescriptor,W=[].slice;function ee(e,t,r){return W.call(e,t,r)}function V(e,t){return t(e)}function X(e){if(!e)throw new Error("Assertion Failed")}function oe(e){f.setImmediate?setImmediate(e):setTimeout(e,0)}function K(e,t){if(typeof t=="string"&&p(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],s=0,u=t.length;s<u;++s){var l=K(e,t[s]);r.push(l)}return r}var h=t.indexOf(".");if(h!==-1){var m=e[t.substr(0,h)];return m===void 0?void 0:K(m,t.substr(h+1))}}function R(e,t,r){if(e&&t!==void 0&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){X(typeof r!="string"&&"length"in r);for(var s=0,u=t.length;s<u;++s)R(e,t[s],r[s])}else{var l,h,m=t.indexOf(".");m!==-1?(l=t.substr(0,m),(h=t.substr(m+1))===""?r===void 0?_(e)&&!isNaN(parseInt(l))?e.splice(l,1):delete e[l]:e[l]=r:R(m=!(m=e[l])||!p(e,l)?e[l]={}:m,h,r)):r===void 0?_(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function F(e){var t,r={};for(t in e)p(e,t)&&(r[t]=e[t]);return r}var ve=[].concat;function Pe(e){return ve.apply([],e)}var Et="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Pe([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return f[e]}),_e=new Set(Et.map(function(e){return f[e]})),Ke=null;function $e(e){return Ke=new WeakMap,e=function t(r){if(!r||typeof r!="object")return r;var s=Ke.get(r);if(s)return s;if(_(r)){s=[],Ke.set(r,s);for(var u=0,l=r.length;u<l;++u)s.push(t(r[u]))}else if(_e.has(r.constructor))s=r;else{var h,m=d(r);for(h in s=m===Object.prototype?{}:Object.create(m),Ke.set(r,s),r)p(r,h)&&(s[h]=t(r[h]))}return s}(e),Ke=null,e}var Me={}.toString;function be(e){return Me.call(e).slice(8,-1)}var Fe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",qe=typeof Fe=="symbol"?function(e){var t;return e!=null&&(t=e[Fe])&&t.apply(e)}:function(){return null};function me(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var pe={};function ue(e){var t,r,s,u;if(arguments.length===1){if(_(e))return e.slice();if(this===pe&&typeof e=="string")return[e];if(u=qe(e)){for(r=[];!(s=u.next()).done;)r.push(s.value);return r}if(e==null)return[e];if(typeof(t=e.length)!="number")return[e];for(r=new Array(t);t--;)r[t]=e[t];return r}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}var ge=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},qt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],kt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(qt),J={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ce(e,t){this.name=e,this.message=t}function et(e,t){return e+". Errors: "+Object.keys(t).map(function(r){return t[r].toString()}).filter(function(r,s,u){return u.indexOf(r)===s}).join(`
`)}function Le(e,t,r,s){this.failures=t,this.failedKeys=s,this.successCount=r,this.message=et(e,t)}function Be(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(r){return t[r]}),this.failuresByPos=t,this.message=et(e,this.failures)}T(ce).from(Error).extend({toString:function(){return this.name+": "+this.message}}),T(Le).from(ce),T(Be).from(ce);var tt=kt.reduce(function(e,t){return e[t]=t+"Error",e},{}),ft=ce,fe=kt.reduce(function(e,t){var r=t+"Error";function s(u,l){this.name=r,u?typeof u=="string"?(this.message="".concat(u).concat(l?`
 `+l:""),this.inner=l||null):typeof u=="object"&&(this.message="".concat(u.name," ").concat(u.message),this.inner=u):(this.message=J[t]||r,this.inner=null)}return T(s).from(ft),e[t]=s,e},{});fe.Syntax=SyntaxError,fe.Type=TypeError,fe.Range=RangeError;var Je=qt.reduce(function(e,t){return e[t+"Error"]=fe[t],e},{}),at=kt.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=fe[t]),e},{});function ye(){}function z(e){return e}function ae(e,t){return e==null||e===z?t:function(r){return t(e(r))}}function Ae(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function nt(e,t){return e===ye?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var s=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var l=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Ae(s,this.onsuccess):s),u&&(this.onerror=this.onerror?Ae(u,this.onerror):u),l!==void 0?l:r}}function rt(e,t){return e===ye?t:function(){e.apply(this,arguments);var r=this.onsuccess,s=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Ae(r,this.onsuccess):r),s&&(this.onerror=this.onerror?Ae(s,this.onerror):s)}}function ke(e,t){return e===ye?t:function(r){var s=e.apply(this,arguments);g(r,s);var u=this.onsuccess,l=this.onerror;return this.onsuccess=null,this.onerror=null,r=t.apply(this,arguments),u&&(this.onsuccess=this.onsuccess?Ae(u,this.onsuccess):u),l&&(this.onerror=this.onerror?Ae(l,this.onerror):l),s===void 0?r===void 0?void 0:r:g(s,r)}}function Qe(e,t){return e===ye?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function He(e,t){return e===ye?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var s=this,u=arguments.length,l=new Array(u);u--;)l[u]=arguments[u];return r.then(function(){return t.apply(s,l)})}return t.apply(this,arguments)}}at.ModifyError=Le,at.DexieError=ce,at.BulkError=Be;var ht=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function un(e){ht=e}var Rt={},dt=100,Et=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,d(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,d(t),e]}(),qt=Et[0],kt=Et[1],Et=Et[2],kt=kt&&kt.then,Cn=qt&&qt.constructor,gr=!!Et,$n=function(e,t){Pn.push([e,t]),Fn&&(queueMicrotask(Oo),Fn=!1)},yr=!0,Fn=!0,Ut=[],In=[],_r=z,Bt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ye,pgp:!1,env:{},finalize:ye},de=Bt,Pn=[],Wt=0,Nn=[];function se(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=de;if(typeof e!="function"){if(e!==Rt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&wr(this,this._value))}this._state=null,this._value=null,++t.ref,function r(s,u){try{u(function(l){if(s._state===null){if(l===s)throw new TypeError("A promise cannot be resolved with itself.");var h=s._lib&&ln();l&&typeof l.then=="function"?r(s,function(m,S){l instanceof se?l._then(m,S):l.then(m,S)}):(s._state=!0,s._value=l,li(s)),h&&cn()}},wr.bind(null,s))}catch(l){wr(s,l)}}(this,e)}var br={get:function(){var e=de,t=Un;function r(s,u){var l=this,h=!e.global&&(e!==de||t!==Un),m=h&&!Ft(),S=new se(function(k,j){kr(l,new ui(fi(s,e,h,m),fi(u,e,h,m),k,j,e))});return this._consoleTask&&(S._consoleTask=this._consoleTask),S}return r.prototype=Rt,r},set:function(e){N(this,"then",e&&e.prototype===Rt?br:{get:function(){return e},set:br.set})}};function ui(e,t,r,s,u){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=s,this.psd=u}function wr(e,t){var r,s;In.push(t),e._state===null&&(r=e._lib&&ln(),t=_r(t),e._state=!1,e._value=t,s=e,Ut.some(function(u){return u._value===s._value})||Ut.push(s),li(e),r&&cn())}function li(e){var t=e._listeners;e._listeners=[];for(var r=0,s=t.length;r<s;++r)kr(e,t[r]);var u=e._PSD;--u.ref||u.finalize(),Wt===0&&(++Wt,$n(function(){--Wt==0&&Or()},[]))}function kr(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Wt,$n(ko,[r,e,t])}else e._listeners.push(t)}function ko(e,t,r){try{var s,u=t._value;!t._state&&In.length&&(In=[]),s=ht&&t._consoleTask?t._consoleTask.run(function(){return e(u)}):e(u),t._state||In.indexOf(u)!==-1||function(l){for(var h=Ut.length;h;)if(Ut[--h]._value===l._value)return Ut.splice(h,1)}(t),r.resolve(s)}catch(l){r.reject(l)}finally{--Wt==0&&Or(),--r.psd.ref||r.psd.finalize()}}function Oo(){Yt(Bt,function(){ln()&&cn()})}function ln(){var e=yr;return Fn=yr=!1,e}function cn(){var e,t,r;do for(;0<Pn.length;)for(e=Pn,Pn=[],r=e.length,t=0;t<r;++t){var s=e[t];s[0].apply(null,s[1])}while(0<Pn.length);Fn=yr=!0}function Or(){var e=Ut;Ut=[],e.forEach(function(s){s._PSD.onunhandled.call(null,s._value,s)});for(var t=Nn.slice(0),r=t.length;r;)t[--r]()}function Ln(e){return new se(Rt,!1,e)}function Ue(e,t){var r=de;return function(){var s=ln(),u=de;try{return It(r,!0),e.apply(this,arguments)}catch(l){t&&t(l)}finally{It(u,!1),s&&cn()}}}E(se.prototype,{then:br,_then:function(e,t){kr(this,new ui(null,null,e,t,de))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,r=arguments[1];return typeof t=="function"?this.then(null,function(s){return(s instanceof t?r:Ln)(s)}):this.then(null,function(s){return(s&&s.name===t?r:Ln)(s)})},finally:function(e){return this.then(function(t){return se.resolve(e()).then(function(){return t})},function(t){return se.resolve(e()).then(function(){return Ln(t)})})},timeout:function(e,t){var r=this;return e<1/0?new se(function(s,u){var l=setTimeout(function(){return u(new fe.Timeout(t))},e);r.then(s,u).finally(clearTimeout.bind(null,l))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&N(se.prototype,Symbol.toStringTag,"Dexie.Promise"),Bt.env=ci(),E(se,{all:function(){var e=ue.apply(null,arguments).map(Wn);return new se(function(t,r){e.length===0&&t([]);var s=e.length;e.forEach(function(u,l){return se.resolve(u).then(function(h){e[l]=h,--s||t(e)},r)})})},resolve:function(e){return e instanceof se?e:e&&typeof e.then=="function"?new se(function(t,r){e.then(t,r)}):new se(Rt,!0,e)},reject:Ln,race:function(){var e=ue.apply(null,arguments).map(Wn);return new se(function(t,r){e.map(function(s){return se.resolve(s).then(t,r)})})},PSD:{get:function(){return de},set:function(e){return de=e}},totalEchoes:{get:function(){return Un}},newPSD:Mt,usePSD:Yt,scheduler:{get:function(){return $n},set:function(e){$n=e}},rejectionMapper:{get:function(){return _r},set:function(e){_r=e}},follow:function(e,t){return new se(function(r,s){return Mt(function(u,l){var h=de;h.unhandleds=[],h.onunhandled=l,h.finalize=Ae(function(){var m,S=this;m=function(){S.unhandleds.length===0?u():l(S.unhandleds[0])},Nn.push(function k(){m(),Nn.splice(Nn.indexOf(k),1)}),++Wt,$n(function(){--Wt==0&&Or()},[])},h.finalize),e()},t,r,s)})}}),Cn&&(Cn.allSettled&&N(se,"allSettled",function(){var e=ue.apply(null,arguments).map(Wn);return new se(function(t){e.length===0&&t([]);var r=e.length,s=new Array(r);e.forEach(function(u,l){return se.resolve(u).then(function(h){return s[l]={status:"fulfilled",value:h}},function(h){return s[l]={status:"rejected",reason:h}}).then(function(){return--r||t(s)})})})}),Cn.any&&typeof AggregateError<"u"&&N(se,"any",function(){var e=ue.apply(null,arguments).map(Wn);return new se(function(t,r){e.length===0&&r(new AggregateError([]));var s=e.length,u=new Array(s);e.forEach(function(l,h){return se.resolve(l).then(function(m){return t(m)},function(m){u[h]=m,--s||r(new AggregateError(u))})})})}));var it={awaits:0,echoes:0,id:0},So=0,Hn=[],zn=0,Un=0,Co=0;function Mt(e,t,r,s){var u=de,l=Object.create(u);return l.parent=u,l.ref=0,l.global=!1,l.id=++Co,Bt.env,l.env=gr?{Promise:se,PromiseProp:{value:se,configurable:!0,writable:!0},all:se.all,race:se.race,allSettled:se.allSettled,any:se.any,resolve:se.resolve,reject:se.reject}:{},t&&g(l,t),++u.ref,l.finalize=function(){--this.parent.ref||this.parent.finalize()},s=Yt(l,e,r,s),l.ref===0&&l.finalize(),s}function fn(){return it.id||(it.id=++So),++it.awaits,it.echoes+=dt,it.id}function Ft(){return!!it.awaits&&(--it.awaits==0&&(it.id=0),it.echoes=it.awaits*dt,!0)}function Wn(e){return it.echoes&&e&&e.constructor===Cn?(fn(),e.then(function(t){return Ft(),t},function(t){return Ft(),Xe(t)})):e}function $o(){var e=Hn[Hn.length-1];Hn.pop(),It(e,!1)}function It(e,t){var r,s=de;(t?!it.echoes||zn++&&e===de:!zn||--zn&&e===de)||queueMicrotask(t?(function(u){++Un,it.echoes&&--it.echoes!=0||(it.echoes=it.awaits=it.id=0),Hn.push(de),It(u,!0)}).bind(null,e):$o),e!==de&&(de=e,s===Bt&&(Bt.env=ci()),gr&&(r=Bt.env.Promise,t=e.env,(s.global||e.global)&&(Object.defineProperty(f,"Promise",t.PromiseProp),r.all=t.all,r.race=t.race,r.resolve=t.resolve,r.reject=t.reject,t.allSettled&&(r.allSettled=t.allSettled),t.any&&(r.any=t.any))))}function ci(){var e=f.Promise;return gr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(f,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Yt(e,t,r,s,u){var l=de;try{return It(e,!0),t(r,s,u)}finally{It(l,!1)}}function fi(e,t,r,s){return typeof e!="function"?e:function(){var u=de;r&&fn(),It(t,!0);try{return e.apply(this,arguments)}finally{It(u,!1),s&&queueMicrotask(Ft)}}}function Sr(e){Promise===Cn&&it.echoes===0?zn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(""+kt).indexOf("[native code]")===-1&&(fn=Ft=ye);var Xe=se.reject,Et="4.0.1-beta.9",Vt="",Tt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",hi="String expected.",hn=[],Yn=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Po=Yn,Eo=Yn,Vn="__dbnames",Cr="readonly",$r="readwrite";function Gt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var di={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Gn(e){return typeof e!="string"||/\./.test(e)?function(t){return t}:function(t){return t[e]===void 0&&e in t&&delete(t=$e(t))[e],t}}function pi(){throw fe.Type()}function Re(e,t){try{var r=mi(e),s=mi(t);if(r!==s)return r==="Array"?1:s==="Array"?-1:r==="binary"?1:s==="binary"?-1:r==="string"?1:s==="string"?-1:r==="Date"?1:s!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return t<e?1:e<t?-1:0;case"binary":return function(u,l){for(var h=u.length,m=l.length,S=h<m?h:m,k=0;k<S;++k)if(u[k]!==l[k])return u[k]<l[k]?-1:1;return h===m?0:h<m?-1:1}(vi(e),vi(t));case"Array":return function(u,l){for(var h=u.length,m=l.length,S=h<m?h:m,k=0;k<S;++k){var j=Re(u[k],l[k]);if(j!==0)return j}return h===m?0:h<m?-1:1}(e,t)}}catch{}return NaN}function mi(e){var t=typeof e;return t!="object"?t:ArrayBuffer.isView(e)?"binary":(e=be(e),e==="ArrayBuffer"?"binary":e)}function vi(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var gi=(ze.prototype._trans=function(e,t,r){var s=this._tx||de.trans,u=this.name,l=ht&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(e==="readonly"?"read":"write"," ").concat(this.name));function h(k,j,b){if(!b.schema[u])throw new fe.NotFound("Table "+u+" not part of transaction");return t(b.idbtrans,b)}var m=ln();try{var S=s&&s.db._novip===this.db._novip?s===de.trans?s._promise(e,h,r):Mt(function(){return s._promise(e,h,r)},{trans:s,transless:de.transless||de}):function k(j,b,O,C){if(j.idbdb&&(j._state.openComplete||de.letThrough||j._vip)){var P=j._createTransaction(b,O,j._dbSchema);try{P.create(),j._state.PR1398_maxLoop=3}catch(D){return D.name===tt.InvalidState&&j.isOpen()&&0<--j._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),j._close(),j.open().then(function(){return k(j,b,O,C)})):Xe(D)}return P._promise(b,function(D,$){return Mt(function(){return de.trans=P,C(D,$,P)})}).then(function(D){if(b==="readwrite")try{P.idbtrans.commit()}catch{}return b==="readonly"?D:P._completion.then(function(){return D})})}if(j._state.openComplete)return Xe(new fe.DatabaseClosed(j._state.dbOpenError));if(!j._state.isBeingOpened){if(!j._state.autoOpen)return Xe(new fe.DatabaseClosed);j.open().catch(ye)}return j._state.dbReadyPromise.then(function(){return k(j,b,O,C)})}(this.db,e,[this.name],h);return l&&(S._consoleTask=l,S=S.catch(function(k){return console.trace(k),Xe(k)})),S}finally{m&&cn()}},ze.prototype.get=function(e,t){var r=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?Xe(new fe.Type("Invalid argument to Table.get()")):this._trans("readonly",function(s){return r.core.get({trans:s,key:e}).then(function(u){return r.hook.reading.fire(u)})}).then(t)},ze.prototype.where=function(e){if(typeof e=="string")return new this.db.WhereClause(this,e);if(_(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=v(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(S){if(S.compound&&t.every(function(j){return 0<=S.keyPath.indexOf(j)})){for(var k=0;k<t.length;++k)if(t.indexOf(S.keyPath[k])===-1)return!1;return!0}return!1}).sort(function(S,k){return S.keyPath.length-k.keyPath.length})[0];if(r&&this.db._maxKey!==Vt){var h=r.keyPath.slice(0,t.length);return this.where(h).equals(h.map(function(k){return e[k]}))}!r&&ht&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var s=this.schema.idxByName,u=this.db._deps.indexedDB;function l(S,k){return u.cmp(S,k)===0}var m=t.reduce(function(O,k){var j=O[0],b=O[1],O=s[k],C=e[k];return[j||O,j||!O?Gt(b,O&&O.multi?function(P){return P=K(P,k),_(P)&&P.some(function(D){return l(C,D)})}:function(P){return l(C,K(P,k))}):b]},[null,null]),h=m[0],m=m[1];return h?this.where(h.name).equals(e[h.keyPath]).filter(m):r?this.filter(m):this.where(t).equals("")},ze.prototype.filter=function(e){return this.toCollection().and(e)},ze.prototype.count=function(e){return this.toCollection().count(e)},ze.prototype.offset=function(e){return this.toCollection().offset(e)},ze.prototype.limit=function(e){return this.toCollection().limit(e)},ze.prototype.each=function(e){return this.toCollection().each(e)},ze.prototype.toArray=function(e){return this.toCollection().toArray(e)},ze.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},ze.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,_(e)?"[".concat(e.join("+"),"]"):e))},ze.prototype.reverse=function(){return this.toCollection().reverse()},ze.prototype.mapToClass=function(e){var t,r=this.db,s=this.name;function u(){return t!==null&&t.apply(this,arguments)||this}(this.schema.mappedClass=e).prototype instanceof pi&&(function(S,k){if(typeof k!="function"&&k!==null)throw new TypeError("Class extends value "+String(k)+" is not a constructor or null");function j(){this.constructor=S}o(S,k),S.prototype=k===null?Object.create(k):(j.prototype=k.prototype,new j)}(u,t=e),Object.defineProperty(u.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),u.prototype.table=function(){return s},e=u);for(var l=new Set,h=e.prototype;h;h=d(h))Object.getOwnPropertyNames(h).forEach(function(S){return l.add(S)});function m(S){if(!S)return S;var k,j=Object.create(e.prototype);for(k in S)if(!l.has(k))try{j[k]=S[k]}catch{}return j}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=m,this.hook("reading",m),e},ze.prototype.defineClass=function(){return this.mapToClass(function(e){g(this,e)})},ze.prototype.add=function(e,t){var r=this,s=this.schema.primKey,u=s.auto,l=s.keyPath,h=e;return l&&u&&(h=Gn(l)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"add",keys:t!=null?[t]:null,values:[h]})}).then(function(m){return m.numFailures?se.reject(m.failures[0]):m.lastResult}).then(function(m){if(l)try{R(e,l,m)}catch{}return m})},ze.prototype.update=function(e,t){return typeof e!="object"||_(e)?this.where(":id").equals(e).modify(t):(e=K(e,this.schema.primKey.keyPath),e===void 0?Xe(new fe.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(e).modify(t))},ze.prototype.put=function(e,t){var r=this,s=this.schema.primKey,u=s.auto,l=s.keyPath,h=e;return l&&u&&(h=Gn(l)(e)),this._trans("readwrite",function(m){return r.core.mutate({trans:m,type:"put",values:[h],keys:t!=null?[t]:null})}).then(function(m){return m.numFailures?se.reject(m.failures[0]):m.lastResult}).then(function(m){if(l)try{R(e,l,m)}catch{}return m})},ze.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[e]})}).then(function(r){return r.numFailures?se.reject(r.failures[0]):void 0})},ze.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:di})}).then(function(t){return t.numFailures?se.reject(t.failures[0]):void 0})},ze.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:e,trans:r}).then(function(s){return s.map(function(u){return t.hook.reading.fire(u)})})})},ze.prototype.bulkAdd=function(e,t,r){var s=this,u=Array.isArray(t)?t:void 0,l=(r=r||(u?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var k=s.schema.primKey,m=k.auto,k=k.keyPath;if(k&&u)throw new fe.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(u&&u.length!==e.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var S=e.length,k=k&&m?e.map(Gn(k)):e;return s.core.mutate({trans:h,type:"add",keys:u,values:k,wantResults:l}).then(function(P){var b=P.numFailures,O=P.results,C=P.lastResult,P=P.failures;if(b===0)return l?O:C;throw new Be("".concat(s.name,".bulkAdd(): ").concat(b," of ").concat(S," operations failed"),P)})})},ze.prototype.bulkPut=function(e,t,r){var s=this,u=Array.isArray(t)?t:void 0,l=(r=r||(u?void 0:t))?r.allKeys:void 0;return this._trans("readwrite",function(h){var k=s.schema.primKey,m=k.auto,k=k.keyPath;if(k&&u)throw new fe.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(u&&u.length!==e.length)throw new fe.InvalidArgument("Arguments objects and keys must have the same length");var S=e.length,k=k&&m?e.map(Gn(k)):e;return s.core.mutate({trans:h,type:"put",keys:u,values:k,wantResults:l}).then(function(P){var b=P.numFailures,O=P.results,C=P.lastResult,P=P.failures;if(b===0)return l?O:C;throw new Be("".concat(s.name,".bulkPut(): ").concat(b," of ").concat(S," operations failed"),P)})})},ze.prototype.bulkUpdate=function(e){var t=this,r=this.core,s=e.map(function(h){return h.key}),u=e.map(function(h){return h.changes}),l=[];return this._trans("readwrite",function(h){return r.getMany({trans:h,keys:s,cache:"clone"}).then(function(m){var S=[],k=[];e.forEach(function(b,O){var C=b.key,P=b.changes,D=m[O];if(D){for(var $=0,A=Object.keys(P);$<A.length;$++){var x=A[$],q=P[x];if(x===t.schema.primKey.keyPath){if(Re(q,C)!==0)throw new fe.Constraint("Cannot update primary key in bulkUpdate()")}else R(D,x,q)}l.push(O),S.push(C),k.push(D)}});var j=S.length;return r.mutate({trans:h,type:"put",keys:S,values:k,updates:{keys:s,changeSpecs:u}}).then(function(b){var O=b.numFailures,C=b.failures;if(O===0)return j;for(var P=0,D=Object.keys(C);P<D.length;P++){var $,A=D[P],x=l[Number(A)];x!=null&&($=C[A],delete C[A],C[x]=$)}throw new Be("".concat(t.name,".bulkUpdate(): ").concat(O," of ").concat(j," operations failed"),C)})})})},ze.prototype.bulkDelete=function(e){var t=this,r=e.length;return this._trans("readwrite",function(s){return t.core.mutate({trans:s,type:"delete",keys:e})}).then(function(h){var u=h.numFailures,l=h.lastResult,h=h.failures;if(u===0)return l;throw new Be("".concat(t.name,".bulkDelete(): ").concat(u," of ").concat(r," operations failed"),h)})},ze);function ze(){}function En(e){function t(h,m){if(m){for(var S=arguments.length,k=new Array(S-1);--S;)k[S-1]=arguments[S];return r[h].subscribe.apply(null,k),e}if(typeof h=="string")return r[h]}var r={};t.addEventType=l;for(var s=1,u=arguments.length;s<u;++s)l(arguments[s]);return t;function l(h,m,S){if(typeof h!="object"){var k;m=m||Qe;var j={subscribers:[],fire:S=S||ye,subscribe:function(b){j.subscribers.indexOf(b)===-1&&(j.subscribers.push(b),j.fire=m(j.fire,b))},unsubscribe:function(b){j.subscribers=j.subscribers.filter(function(O){return O!==b}),j.fire=j.subscribers.reduce(m,S)}};return r[h]=t[h]=j}v(k=h).forEach(function(b){var O=k[b];if(_(O))l(b,k[b][0],k[b][1]);else{if(O!=="asap")throw new fe.InvalidArgument("Invalid event config");var C=l(b,z,function(){for(var P=arguments.length,D=new Array(P);P--;)D[P]=arguments[P];C.subscribers.forEach(function($){oe(function(){$.apply(null,D)})})})}})}}function jn(e,t){return T(t).from({prototype:e}),t}function dn(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Pr(e,t){e.filter=Gt(e.filter,t)}function Er(e,t,r){var s=e.replayFilter;e.replayFilter=s?function(){return Gt(s(),t())}:t,e.justLimit=r&&!s}function Jn(e,t){if(e.isPrimKey)return t.primaryKey;var r=t.getIndexByKeyPath(e.index);if(!r)throw new fe.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function yi(e,t,r){var s=Jn(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:s,range:e.range}})}function Qn(e,t,r,s){var u=e.replayFilter?Gt(e.filter,e.replayFilter()):e.filter;if(e.or){var l={},h=function(m,S,k){var j,b;u&&!u(S,k,function(O){return S.stop(O)},function(O){return S.fail(O)})||((b=""+(j=S.primaryKey))=="[object ArrayBuffer]"&&(b=""+new Uint8Array(j)),p(l,b)||(l[b]=!0,t(m,S,k)))};return Promise.all([e.or._iterate(h,r),_i(yi(e,s,r),e.algorithm,h,!e.keysOnly&&e.valueMapper)])}return _i(yi(e,s,r),Gt(e.algorithm,u),t,!e.keysOnly&&e.valueMapper)}function _i(e,t,r,s){var u=Ue(s?function(l,h,m){return r(s(l),h,m)}:r);return e.then(function(l){if(l)return l.start(function(){var h=function(){return l.continue()};t&&!t(l,function(m){return h=m},function(m){l.stop(m),h=ye},function(m){l.fail(m),h=ye})||u(l.value,l,function(m){return h=m}),h()})})}var jo=(xe.prototype._read=function(e,t){var r=this._ctx;return r.error?r.table._trans(null,Xe.bind(null,r.error)):r.table._trans("readonly",e).then(t)},xe.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Xe.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},xe.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=Gt(t.algorithm,e)},xe.prototype._iterate=function(e,t){return Qn(this._ctx,e,t,this._ctx.table.core)},xe.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return e&&g(r,e),t._ctx=r,t},xe.prototype.raw=function(){return this._ctx.valueMapper=null,this},xe.prototype.each=function(e){var t=this._ctx;return this._read(function(r){return Qn(t,e,r,t.table.core)})},xe.prototype.count=function(e){var t=this;return this._read(function(r){var s=t._ctx,u=s.table.core;if(dn(s,!0))return u.count({trans:r,query:{index:Jn(s,u.schema),range:s.range}}).then(function(h){return Math.min(h,s.limit)});var l=0;return Qn(s,function(){return++l,!1},r,u).then(function(){return l})}).then(e)},xe.prototype.sortBy=function(e,t){var r=e.split(".").reverse(),s=r[0],u=r.length-1;function l(S,k){return k?l(S[r[k]],k-1):S[s]}var h=this._ctx.dir==="next"?1:-1;function m(S,k){return S=l(S,u),k=l(k,u),S<k?-h:k<S?h:0}return this.toArray(function(S){return S.sort(m)}).then(t)},xe.prototype.toArray=function(e){var t=this;return this._read(function(r){var s=t._ctx;if(s.dir==="next"&&dn(s,!0)&&0<s.limit){var u=s.valueMapper,l=Jn(s,s.table.core.schema);return s.table.core.query({trans:r,limit:s.limit,values:!0,query:{index:l,range:s.range}}).then(function(m){return m=m.result,u?m.map(u):m})}var h=[];return Qn(s,function(m){return h.push(m)},r,s.table.core).then(function(){return h})},e)},xe.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,dn(t)?Er(t,function(){var r=e;return function(s,u){return r===0||(r===1?--r:u(function(){s.advance(r),r=0}),!1)}}):Er(t,function(){var r=e;return function(){return--r<0}})),this},xe.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Er(this._ctx,function(){var t=e;return function(r,s,u){return--t<=0&&s(u),0<=t}},!0),this},xe.prototype.until=function(e,t){return Pr(this._ctx,function(r,s,u){return!e(r.value)||(s(u),t)}),this},xe.prototype.first=function(e){return this.limit(1).toArray(function(t){return t[0]}).then(e)},xe.prototype.last=function(e){return this.reverse().first(e)},xe.prototype.filter=function(e){var t;return Pr(this._ctx,function(r){return e(r.value)}),(t=this._ctx).isMatch=Gt(t.isMatch,e),this},xe.prototype.and=function(e){return this.filter(e)},xe.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},xe.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},xe.prototype.desc=function(){return this.reverse()},xe.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,s){e(s.key,s)})},xe.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},xe.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,s){e(s.primaryKey,s)})},xe.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(s,u){r.push(u.key)}).then(function(){return r}).then(e)},xe.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir==="next"&&dn(t,!0)&&0<t.limit)return this._read(function(s){var u=Jn(t,t.table.core.schema);return t.table.core.query({trans:s,values:!1,limit:t.limit,query:{index:u,range:t.range}})}).then(function(s){return s.result}).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each(function(s,u){r.push(u.primaryKey)}).then(function(){return r}).then(e)},xe.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},xe.prototype.firstKey=function(e){return this.limit(1).keys(function(t){return t[0]}).then(e)},xe.prototype.lastKey=function(e){return this.reverse().firstKey(e)},xe.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return Pr(this._ctx,function(u){var s=u.primaryKey.toString(),u=p(t,s);return t[s]=!0,!u}),this},xe.prototype.modify=function(e){var t=this,r=this._ctx;return this._write(function(s){var u,l,h;h=typeof e=="function"?e:(u=v(e),l=u.length,function($){for(var A=!1,x=0;x<l;++x){var q=u[x],M=e[q];K($,q)!==M&&(R($,q,M),A=!0)}return A});function m($,q){var x=q.failures,q=q.numFailures;P+=$-q;for(var M=0,L=v(x);M<L.length;M++){var Z=L[M];C.push(x[Z])}}var S=r.table.core,k=S.schema.primaryKey,j=k.outbound,b=k.extractKey,O=t.db._options.modifyChunkSize||200,C=[],P=0,D=[];return t.clone().primaryKeys().then(function($){function A(x){var q=Math.min(O,$.length-x);return S.getMany({trans:s,keys:$.slice(x,x+q),cache:"immutable"}).then(function(M){for(var L=[],Z=[],U=j?[]:null,te=[],ie=0;ie<q;++ie){var le=M[ie],we={value:$e(le),primKey:$[x+ie]};h.call(we,we.value,we)!==!1&&(we.value==null?te.push($[x+ie]):j||Re(b(le),b(we.value))===0?(Z.push(we.value),j&&U.push($[x+ie])):(te.push($[x+ie]),L.push(we.value)))}var Ee=dn(r)&&r.limit===1/0&&(typeof e!="function"||e===jr)&&{index:r.index,range:r.range};return Promise.resolve(0<L.length&&S.mutate({trans:s,type:"add",values:L}).then(function(Se){for(var Ne in Se.failures)te.splice(parseInt(Ne),1);m(L.length,Se)})).then(function(){return(0<Z.length||Ee&&typeof e=="object")&&S.mutate({trans:s,type:"put",keys:U,values:Z,criteria:Ee,changeSpec:typeof e!="function"&&e}).then(function(Se){return m(Z.length,Se)})}).then(function(){return(0<te.length||Ee&&e===jr)&&S.mutate({trans:s,type:"delete",keys:te,criteria:Ee}).then(function(Se){return m(te.length,Se)})}).then(function(){return $.length>x+q&&A(x+O)})})}return A(0).then(function(){if(0<C.length)throw new Le("Error modifying one or more objects",C,P,D);return $.length})})})},xe.prototype.delete=function(){var e=this._ctx,t=e.range;return dn(e)&&(e.isPrimKey&&!Eo||t.type===3)?this._write(function(r){var s=e.table.core.schema.primaryKey,u=t;return e.table.core.count({trans:r,query:{index:s,range:u}}).then(function(l){return e.table.core.mutate({trans:r,type:"deleteRange",range:u}).then(function(h){var m=h.failures;if(h.lastResult,h.results,h=h.numFailures,h)throw new Le("Could not delete some values",Object.keys(m).map(function(S){return m[S]}),l-h);return l-h})})}):this.modify(jr)},xe);function xe(){}var jr=function(e,t){return t.value=null};function Do(e,t){return e<t?-1:e===t?0:1}function xo(e,t){return t<e?-1:e===t?0:1}function yt(e,t,r){return e=e instanceof wi?new e.Collection(e):e,e._ctx.error=new(r||TypeError)(t),e}function pn(e){return new e.Collection(e,function(){return bi("")}).limit(0)}function Xn(e,t,r,s){var u,l,h,m,S,k,j,b=r.length;if(!r.every(function(P){return typeof P=="string"}))return yt(e,hi);function O(P){u=P==="next"?function($){return $.toUpperCase()}:function($){return $.toLowerCase()},l=P==="next"?function($){return $.toLowerCase()}:function($){return $.toUpperCase()},h=P==="next"?Do:xo;var D=r.map(function($){return{lower:l($),upper:u($)}}).sort(function($,A){return h($.lower,A.lower)});m=D.map(function($){return $.upper}),S=D.map(function($){return $.lower}),j=(k=P)==="next"?"":s}O("next"),e=new e.Collection(e,function(){return Nt(m[0],S[b-1]+s)}),e._ondirectionchange=function(P){O(P)};var C=0;return e._addAlgorithm(function(P,D,$){var A=P.key;if(typeof A!="string")return!1;var x=l(A);if(t(x,S,C))return!0;for(var q=null,M=C;M<b;++M){var L=function(Z,U,te,ie,le,we){for(var Ee=Math.min(Z.length,ie.length),Se=-1,Ne=0;Ne<Ee;++Ne){var _t=U[Ne];if(_t!==ie[Ne])return le(Z[Ne],te[Ne])<0?Z.substr(0,Ne)+te[Ne]+te.substr(Ne+1):le(Z[Ne],ie[Ne])<0?Z.substr(0,Ne)+ie[Ne]+te.substr(Ne+1):0<=Se?Z.substr(0,Se)+U[Se]+te.substr(Se+1):null;le(Z[Ne],_t)<0&&(Se=Ne)}return Ee<ie.length&&we==="next"?Z+te.substr(Z.length):Ee<Z.length&&we==="prev"?Z.substr(0,te.length):Se<0?null:Z.substr(0,Se)+ie[Se]+te.substr(Se+1)}(A,x,m[M],S[M],h,k);L===null&&q===null?C=M+1:(q===null||0<h(q,L))&&(q=L)}return D(q!==null?function(){P.continue(q+j)}:$),!1}),e}function Nt(e,t,r,s){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:s}}function bi(e){return{type:1,lower:e,upper:e}}var wi=(Object.defineProperty(ot.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),ot.prototype.between=function(e,t,r,s){r=r!==!1,s=s===!0;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(r||s)&&(!r||!s)?pn(this):new this.Collection(this,function(){return Nt(e,t,!r,!s)})}catch{return yt(this,Tt)}},ot.prototype.equals=function(e){return e==null?yt(this,Tt):new this.Collection(this,function(){return bi(e)})},ot.prototype.above=function(e){return e==null?yt(this,Tt):new this.Collection(this,function(){return Nt(e,void 0,!0)})},ot.prototype.aboveOrEqual=function(e){return e==null?yt(this,Tt):new this.Collection(this,function(){return Nt(e,void 0,!1)})},ot.prototype.below=function(e){return e==null?yt(this,Tt):new this.Collection(this,function(){return Nt(void 0,e,!1,!0)})},ot.prototype.belowOrEqual=function(e){return e==null?yt(this,Tt):new this.Collection(this,function(){return Nt(void 0,e)})},ot.prototype.startsWith=function(e){return typeof e!="string"?yt(this,hi):this.between(e,e+Vt,!0,!0)},ot.prototype.startsWithIgnoreCase=function(e){return e===""?this.startsWith(e):Xn(this,function(t,r){return t.indexOf(r[0])===0},[e],Vt)},ot.prototype.equalsIgnoreCase=function(e){return Xn(this,function(t,r){return t===r[0]},[e],"")},ot.prototype.anyOfIgnoreCase=function(){var e=ue.apply(pe,arguments);return e.length===0?pn(this):Xn(this,function(t,r){return r.indexOf(t)!==-1},e,"")},ot.prototype.startsWithAnyOfIgnoreCase=function(){var e=ue.apply(pe,arguments);return e.length===0?pn(this):Xn(this,function(t,r){return r.some(function(s){return t.indexOf(s)===0})},e,Vt)},ot.prototype.anyOf=function(){var e=this,t=ue.apply(pe,arguments),r=this._cmp;try{t.sort(r)}catch{return yt(this,Tt)}if(t.length===0)return pn(this);var s=new this.Collection(this,function(){return Nt(t[0],t[t.length-1])});s._ondirectionchange=function(l){r=l==="next"?e._ascending:e._descending,t.sort(r)};var u=0;return s._addAlgorithm(function(l,h,m){for(var S=l.key;0<r(S,t[u]);)if(++u===t.length)return h(m),!1;return r(S,t[u])===0||(h(function(){l.continue(t[u])}),!1)}),s},ot.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},ot.prototype.noneOf=function(){var e=ue.apply(pe,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return yt(this,Tt)}var t=e.reduce(function(r,s){return r?r.concat([[r[r.length-1][1],s]]):[[-1/0,s]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},ot.prototype.inAnyRange=function(A,t){var r=this,s=this._cmp,u=this._ascending,l=this._descending,h=this._min,m=this._max;if(A.length===0)return pn(this);if(!A.every(function(x){return x[0]!==void 0&&x[1]!==void 0&&u(x[0],x[1])<=0}))return yt(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",fe.InvalidArgument);var S=!t||t.includeLowers!==!1,k=t&&t.includeUppers===!0,j,b=u;function O(x,q){return b(x[0],q[0])}try{(j=A.reduce(function(x,q){for(var M=0,L=x.length;M<L;++M){var Z=x[M];if(s(q[0],Z[1])<0&&0<s(q[1],Z[0])){Z[0]=h(Z[0],q[0]),Z[1]=m(Z[1],q[1]);break}}return M===L&&x.push(q),x},[])).sort(O)}catch{return yt(this,Tt)}var C=0,P=k?function(x){return 0<u(x,j[C][1])}:function(x){return 0<=u(x,j[C][1])},D=S?function(x){return 0<l(x,j[C][0])}:function(x){return 0<=l(x,j[C][0])},$=P,A=new this.Collection(this,function(){return Nt(j[0][0],j[j.length-1][1],!S,!k)});return A._ondirectionchange=function(x){b=x==="next"?($=P,u):($=D,l),j.sort(O)},A._addAlgorithm(function(x,q,M){for(var L,Z=x.key;$(Z);)if(++C===j.length)return q(M),!1;return!P(L=Z)&&!D(L)||(r._cmp(Z,j[C][1])===0||r._cmp(Z,j[C][0])===0||q(function(){b===u?x.continue(j[C][0]):x.continue(j[C][1])}),!1)}),A},ot.prototype.startsWithAnyOf=function(){var e=ue.apply(pe,arguments);return e.every(function(t){return typeof t=="string"})?e.length===0?pn(this):this.inAnyRange(e.map(function(t){return[t,t+Vt]})):yt(this,"startsWithAnyOf() only works with strings")},ot);function ot(){}function jt(e){return Ue(function(t){return Dn(t),e(t.target.error),!1})}function Dn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var xn="storagemutated",Zn="x-storagemutated-1",Lt=En(null,xn),Ao=(Dt.prototype._lock=function(){return X(!de.global),++this._reculock,this._reculock!==1||de.global||(de.lockOwnerFor=this),this},Dt.prototype._unlock=function(){if(X(!de.global),--this._reculock==0)for(de.global||(de.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Yt(e[1],e[0])}catch{}}return this},Dt.prototype._locked=function(){return this._reculock&&de.lockOwnerFor!==this},Dt.prototype.create=function(e){var t=this;if(!this.mode)return this;var r=this.db.idbdb,s=this.db._state.dbOpenError;if(X(!this.idbtrans),!e&&!r)switch(s&&s.name){case"DatabaseClosedError":throw new fe.DatabaseClosed(s);case"MissingAPIError":throw new fe.MissingAPI(s.message,s);default:throw new fe.OpenFailed(s)}if(!this.active)throw new fe.TransactionInactive;return X(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||r).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ue(function(u){Dn(u),t._reject(e.error)}),e.onabort=Ue(function(u){Dn(u),t.active&&t._reject(new fe.Abort(e.error)),t.active=!1,t.on("abort").fire(u)}),e.oncomplete=Ue(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&Lt.storagemutated.fire(e.mutatedParts)}),this},Dt.prototype._promise=function(e,t,r){var s=this;if(e==="readwrite"&&this.mode!=="readwrite")return Xe(new fe.ReadOnly("Transaction is readonly"));if(!this.active)return Xe(new fe.TransactionInactive);if(this._locked())return new se(function(l,h){s._blockedFuncs.push([function(){s._promise(e,t,r).then(l,h)},de])});if(r)return Mt(function(){var l=new se(function(h,m){s._lock();var S=t(h,m,s);S&&S.then&&S.then(h,m)});return l.finally(function(){return s._unlock()}),l._lib=!0,l});var u=new se(function(l,h){var m=t(l,h,s);m&&m.then&&m.then(l,h)});return u._lib=!0,u},Dt.prototype._root=function(){return this.parent?this.parent._root():this},Dt.prototype.waitFor=function(e){var t,r=this._root(),s=se.resolve(e);r._waitingFor?r._waitingFor=r._waitingFor.then(function(){return s}):(r._waitingFor=s,r._waitingQueue=[],t=r.idbtrans.objectStore(r.storeNames[0]),function l(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(t.get(-1/0).onsuccess=l)}());var u=r._waitingFor;return new se(function(l,h){s.then(function(m){return r._waitingQueue.push(Ue(l.bind(null,m)))},function(m){return r._waitingQueue.push(Ue(h.bind(null,m)))}).finally(function(){r._waitingFor===u&&(r._waitingFor=null)})})},Dt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new fe.Abort))},Dt.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(p(t,e))return t[e];var r=this.schema[e];if(!r)throw new fe.NotFound("Table "+e+" not part of transaction");return r=new this.db.Table(e,r,this),r.core=this.db.core.table(e),t[e]=r},Dt);function Dt(){}function Dr(e,t,r,s,u,l,h){return{name:e,keyPath:t,unique:r,multi:s,auto:u,compound:l,src:(r&&!h?"&":"")+(s?"*":"")+(u?"++":"")+ki(t)}}function ki(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function xr(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:(s=function(u){return[u.name,u]},r.reduce(function(u,l,h){return h=s(l,h),h&&(u[h[0]]=h[1]),u},{}))};var s}var An=function(e){try{return e.only([[]]),An=function(){return[[]]},[[]]}catch{return An=function(){return Vt},Vt}};function Ar(e){return e==null?function(){}:typeof e=="string"?(t=e).split(".").length===1?function(r){return r[t]}:function(r){return K(r,t)}:function(r){return K(r,e)};var t}function Oi(e){return[].slice.call(e)}var Ro=0;function Rn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function To(e,t,S){function s($){if($.type===3)return null;if($.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var C=$.lower,P=$.upper,D=$.lowerOpen,$=$.upperOpen;return C===void 0?P===void 0?null:t.upperBound(P,!!$):P===void 0?t.lowerBound(C,!!D):t.bound(C,P,!!D,!!$)}function u(O){var C,P=O.name;return{name:P,schema:O,mutate:function(D){var $=D.trans,A=D.type,x=D.keys,q=D.values,M=D.range;return new Promise(function(L,Z){L=Ue(L);var U=$.objectStore(P),te=U.keyPath==null,ie=A==="put"||A==="add";if(!ie&&A!=="delete"&&A!=="deleteRange")throw new Error("Invalid operation type: "+A);var le,we=(x||q||{length:1}).length;if(x&&q&&x.length!==q.length)throw new Error("Given keys array must have same length as given values array.");if(we===0)return L({numFailures:0,failures:{},results:[],lastResult:void 0});function Ee(pt){++_t,Dn(pt)}var Se=[],Ne=[],_t=0;if(A==="deleteRange"){if(M.type===4)return L({numFailures:_t,failures:Ne,results:[],lastResult:void 0});M.type===3?Se.push(le=U.clear()):Se.push(le=U.delete(s(M)))}else{var te=ie?te?[q,x]:[q,null]:[x,null],Oe=te[0],Kt=te[1];if(ie)for(var lt=0;lt<we;++lt)Se.push(le=Kt&&Kt[lt]!==void 0?U[A](Oe[lt],Kt[lt]):U[A](Oe[lt])),le.onerror=Ee;else for(lt=0;lt<we;++lt)Se.push(le=U[A](Oe[lt])),le.onerror=Ee}function hr(pt){pt=pt.target.result,Se.forEach(function(Zt,Qr){return Zt.error!=null&&(Ne[Qr]=Zt.error)}),L({numFailures:_t,failures:Ne,results:A==="delete"?x:Se.map(function(Zt){return Zt.result}),lastResult:pt})}le.onerror=function(pt){Ee(pt),hr(pt)},le.onsuccess=hr})},getMany:function(D){var $=D.trans,A=D.keys;return new Promise(function(x,q){x=Ue(x);for(var M,L=$.objectStore(P),Z=A.length,U=new Array(Z),te=0,ie=0,le=function(Se){Se=Se.target,U[Se._pos]=Se.result,++ie===te&&x(U)},we=jt(q),Ee=0;Ee<Z;++Ee)A[Ee]!=null&&((M=L.get(A[Ee]))._pos=Ee,M.onsuccess=le,M.onerror=we,++te);te===0&&x(U)})},get:function(D){var $=D.trans,A=D.key;return new Promise(function(x,q){x=Ue(x);var M=$.objectStore(P).get(A);M.onsuccess=function(L){return x(L.target.result)},M.onerror=jt(q)})},query:(C=k,function(D){return new Promise(function($,A){$=Ue($);var x,q,M,te=D.trans,L=D.values,Z=D.limit,le=D.query,U=Z===1/0?void 0:Z,ie=le.index,le=le.range,te=te.objectStore(P),ie=ie.isPrimaryKey?te:te.index(ie.name),le=s(le);if(Z===0)return $({result:[]});C?((U=L?ie.getAll(le,U):ie.getAllKeys(le,U)).onsuccess=function(we){return $({result:we.target.result})},U.onerror=jt(A)):(x=0,q=!L&&"openKeyCursor"in ie?ie.openKeyCursor(le):ie.openCursor(le),M=[],q.onsuccess=function(we){var Ee=q.result;return Ee?(M.push(L?Ee.value:Ee.primaryKey),++x===Z?$({result:M}):void Ee.continue()):$({result:M})},q.onerror=jt(A))})}),openCursor:function(D){var $=D.trans,A=D.values,x=D.query,q=D.reverse,M=D.unique;return new Promise(function(L,Z){L=Ue(L);var ie=x.index,U=x.range,te=$.objectStore(P),te=ie.isPrimaryKey?te:te.index(ie.name),ie=q?M?"prevunique":"prev":M?"nextunique":"next",le=!A&&"openKeyCursor"in te?te.openKeyCursor(s(U),ie):te.openCursor(s(U),ie);le.onerror=jt(Z),le.onsuccess=Ue(function(we){var Ee,Se,Ne,_t,Oe=le.result;Oe?(Oe.___id=++Ro,Oe.done=!1,Ee=Oe.continue.bind(Oe),Se=(Se=Oe.continuePrimaryKey)&&Se.bind(Oe),Ne=Oe.advance.bind(Oe),_t=function(){throw new Error("Cursor not stopped")},Oe.trans=$,Oe.stop=Oe.continue=Oe.continuePrimaryKey=Oe.advance=function(){throw new Error("Cursor not started")},Oe.fail=Ue(Z),Oe.next=function(){var Kt=this,lt=1;return this.start(function(){return lt--?Kt.continue():Kt.stop()}).then(function(){return Kt})},Oe.start=function(Kt){function lt(){if(le.result)try{Kt()}catch(pt){Oe.fail(pt)}else Oe.done=!0,Oe.start=function(){throw new Error("Cursor behind last entry")},Oe.stop()}var hr=new Promise(function(pt,Zt){pt=Ue(pt),le.onerror=jt(Zt),Oe.fail=Zt,Oe.stop=function(Qr){Oe.stop=Oe.continue=Oe.continuePrimaryKey=Oe.advance=_t,pt(Qr)}});return le.onsuccess=Ue(function(pt){le.onsuccess=lt,lt()}),Oe.continue=Ee,Oe.continuePrimaryKey=Se,Oe.advance=Ne,lt(),hr},L(Oe)):L(null)},Z)})},count:function(D){var $=D.query,A=D.trans,x=$.index,q=$.range;return new Promise(function(M,L){var Z=A.objectStore(P),U=x.isPrimaryKey?Z:Z.index(x.name),Z=s(q),U=Z?U.count(Z):U.count();U.onsuccess=Ue(function(te){return M(te.target.result)}),U.onerror=jt(L)})}}}var l,h,m,j=(h=S,m=Oi((l=e).objectStoreNames),{schema:{name:l.name,tables:m.map(function(O){return h.objectStore(O)}).map(function(O){var C=O.keyPath,$=O.autoIncrement,P=_(C),D={},$={name:O.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:C==null,compound:P,keyPath:C,autoIncrement:$,unique:!0,extractKey:Ar(C)},indexes:Oi(O.indexNames).map(function(A){return O.index(A)}).map(function(M){var x=M.name,q=M.unique,L=M.multiEntry,M=M.keyPath,L={name:x,compound:_(M),keyPath:M,unique:q,multiEntry:L,extractKey:Ar(M)};return D[Rn(M)]=L}),getIndexByKeyPath:function(A){return D[Rn(A)]}};return D[":id"]=$.primaryKey,C!=null&&(D[Rn(C)]=$.primaryKey),$})},hasGetAll:0<m.length&&"getAll"in h.objectStore(m[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),S=j.schema,k=j.hasGetAll,j=S.tables.map(u),b={};return j.forEach(function(O){return b[O.name]=O}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(O){if(!b[O])throw new Error("Table '".concat(O,"' not found"));return b[O]},MIN_KEY:-1/0,MAX_KEY:An(t),schema:S}}function Ko(e,t,r,s){var u=r.IDBKeyRange;return r.indexedDB,{dbcore:(s=To(t,u,s),e.dbcore.reduce(function(l,h){return h=h.create,a(a({},l),h(l))},s))}}function er(e,s){var r=s.db,s=Ko(e._middlewares,r,e._deps,s);e.core=s.dbcore,e.tables.forEach(function(u){var l=u.name;e.core.schema.tables.some(function(h){return h.name===l})&&(u.core=e.core.table(l),e[l]instanceof e.Table&&(e[l].core=u.core))})}function tr(e,t,r,s){r.forEach(function(u){var l=s[u];t.forEach(function(h){var m=function S(k,j){return H(k,j)||(k=d(k))&&S(k,j)}(h,u);(!m||"value"in m&&m.value===void 0)&&(h===e.Transaction.prototype||h instanceof e.Transaction?N(h,u,{get:function(){return this.table(u)},set:function(S){I(this,u,{value:S,writable:!0,configurable:!0,enumerable:!0})}}):h[u]=new e.Table(u,l))})})}function Rr(e,t){t.forEach(function(r){for(var s in r)r[s]instanceof e.Table&&delete r[s]})}function qo(e,t){return e._cfg.version-t._cfg.version}function Bo(e,t,r,s){var u=e._dbSchema;r.objectStoreNames.contains("$meta")&&!u.$meta&&(u.$meta=xr("$meta",Ci("")[0],[]),e._storeNames.push("$meta"));var l=e._createTransaction("readwrite",e._storeNames,u);l.create(r),l._completion.catch(s);var h=l._reject.bind(l),m=de.transless||de;Mt(function(){return de.trans=l,de.transless=m,t!==0?(er(e,r),k=t,((S=l).storeNames.includes("$meta")?S.table("$meta").get("version").then(function(j){return j??k}):se.resolve(k)).then(function(j){return O=j,C=l,P=r,D=[],j=(b=e)._versions,$=b._dbSchema=rr(0,b.idbdb,P),A=!1,(j=j.filter(function(x){return x._cfg.version>=O})).length!==0?(j.forEach(function(x){D.push(function(){var q=$,M=x._cfg.dbschema;ir(b,q,P),ir(b,M,P),$=b._dbSchema=M;var L=Tr(q,M);L.add.forEach(function(le){Kr(P,le[0],le[1].primKey,le[1].indexes)}),L.change.forEach(function(le){if(le.recreate)throw new fe.Upgrade("Not yet support for changing primary key");var we=P.objectStore(le.name);le.add.forEach(function(Ee){return nr(we,Ee)}),le.change.forEach(function(Ee){we.deleteIndex(Ee.name),nr(we,Ee)}),le.del.forEach(function(Ee){return we.deleteIndex(Ee)})});var Z=x._cfg.contentUpgrade;if(Z&&x._cfg.version>O){er(b,P),C._memoizedTables={},A=!0;var U=F(M);L.del.forEach(function(le){U[le]=q[le]}),Rr(b,[b.Transaction.prototype]),tr(b,[b.Transaction.prototype],v(U),U),C.schema=U;var te,ie=ge(Z);return ie&&fn(),L=se.follow(function(){var le;(te=Z(C))&&ie&&(le=Ft.bind(null,null),te.then(le,le))}),te&&typeof te.then=="function"?se.resolve(te):L.then(function(){return te})}}),D.push(function(q){var M,L,Z;A&&Po||(M=x._cfg.dbschema,L=M,Z=q,[].slice.call(Z.db.objectStoreNames).forEach(function(U){return L[U]==null&&Z.db.deleteObjectStore(U)})),Rr(b,[b.Transaction.prototype]),tr(b,[b.Transaction.prototype],b._storeNames,b._dbSchema),C.schema=b._dbSchema}),D.push(function(q){b.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(b.idbdb.version/10)===x._cfg.version?(b.idbdb.deleteObjectStore("$meta"),delete b._dbSchema.$meta,b._storeNames=b._storeNames.filter(function(M){return M!=="$meta"})):q.objectStore("$meta").put(x._cfg.version,"version"))})}),function x(){return D.length?se.resolve(D.shift()(C.idbtrans)).then(x):se.resolve()}().then(function(){Si($,P)})):se.resolve();var b,O,C,P,D,$,A}).catch(h)):(v(u).forEach(function(j){Kr(r,j,u[j].primKey,u[j].indexes)}),er(e,r),void se.follow(function(){return e.on.populate.fire(l)}).catch(h));var S,k})}function Mo(e,t){Si(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var r=rr(0,e.idbdb,t);ir(e,e._dbSchema,t);for(var s=0,u=Tr(r,e._dbSchema).change;s<u.length;s++){var l=function(h){if(h.change.length||h.recreate)return console.warn("Unable to patch indexes of table ".concat(h.name," because it has changes on the type of index or primary key.")),{value:void 0};var m=t.objectStore(h.name);h.add.forEach(function(S){ht&&console.debug("Dexie upgrade patch: Creating missing index ".concat(h.name,".").concat(S.src)),nr(m,S)})}(u[s]);if(typeof l=="object")return l.value}}function Tr(e,t){var r,s={del:[],add:[],change:[]};for(r in e)t[r]||s.del.push(r);for(r in t){var u=e[r],l=t[r];if(u){var h={name:r,def:l,recreate:!1,del:[],add:[],change:[]};if(""+(u.primKey.keyPath||"")!=""+(l.primKey.keyPath||"")||u.primKey.auto!==l.primKey.auto&&!Yn)h.recreate=!0,s.change.push(h);else{var m=u.idxByName,S=l.idxByName,k=void 0;for(k in m)S[k]||h.del.push(k);for(k in S){var j=m[k],b=S[k];j?j.src!==b.src&&h.change.push(b):h.add.push(b)}(0<h.del.length||0<h.add.length||0<h.change.length)&&s.change.push(h)}}else s.add.push([r,l])}return s}function Kr(e,t,r,s){var u=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return s.forEach(function(l){return nr(u,l)}),u}function Si(e,t){v(e).forEach(function(r){t.db.objectStoreNames.contains(r)||(ht&&console.debug("Dexie: Creating missing table",r),Kr(t,r,e[r].primKey,e[r].indexes))})}function nr(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function rr(e,t,r){var s={};return ee(t.objectStoreNames,0).forEach(function(u){for(var l=r.objectStore(u),h=Dr(ki(k=l.keyPath),k||"",!0,!1,!!l.autoIncrement,k&&typeof k!="string",!0),m=[],S=0;S<l.indexNames.length;++S){var j=l.index(l.indexNames[S]),k=j.keyPath,j=Dr(j.name,k,!!j.unique,!!j.multiEntry,!1,k&&typeof k!="string",!1);m.push(j)}s[u]=xr(u,h,m)}),s}function ir(e,t,r){for(var s=r.db.objectStoreNames,u=0;u<s.length;++u){var l=s[u],h=r.objectStore(l);e._hasGetAll="getAll"in h;for(var m=0;m<h.indexNames.length;++m){var S=h.indexNames[m],k=h.index(S).keyPath,j=typeof k=="string"?k:"["+ee(k).join("+")+"]";!t[l]||(k=t[l].idxByName[j])&&(k.name=S,delete t[l].idxByName[j],t[l].idxByName[S]=k)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&f.WorkerGlobalScope&&f instanceof f.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Ci(e){return e.split(",").map(function(t,r){var s=(t=t.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return Dr(s,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),_(u),r===0)})}var Fo=(or.prototype._parseStoresSpec=function(e,t){v(e).forEach(function(r){if(e[r]!==null){var s=Ci(e[r]),u=s.shift();if(u.unique=!0,u.multi)throw new fe.Schema("Primary key cannot be multi-valued");s.forEach(function(l){if(l.auto)throw new fe.Schema("Only primary key can be marked as autoIncrement (++)");if(!l.keyPath)throw new fe.Schema("Index must have a name and cannot be an empty string")}),t[r]=xr(r,u,s)}})},or.prototype.stores=function(r){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?g(this._cfg.storesSource,r):r;var r=t._versions,s={},u={};return r.forEach(function(l){g(s,l._cfg.storesSource),u=l._cfg.dbschema={},l._parseStoresSpec(s,u)}),t._dbSchema=u,Rr(t,[t._allTables,t,t.Transaction.prototype]),tr(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],v(u),u),t._storeNames=v(u),this},or.prototype.upgrade=function(e){return this._cfg.contentUpgrade=He(this._cfg.contentUpgrade||ye,e),this},or);function or(){}function qr(e,t){var r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Qt(Vn,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),r.table("dbnames")}function Br(e){return e&&typeof e.databases=="function"}function Mr(e){return Mt(function(){return de.letThrough=!0,e()})}function Fr(e){return!("from"in e)}var ut=function(e,t){if(!this){var r=new ut;return e&&"d"in e&&g(r,e),r}g(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function Tn(e,t,r){var s=Re(t,r);if(!isNaN(s)){if(0<s)throw RangeError();if(Fr(e))return g(e,{from:t,to:r,d:1});var u=e.l,s=e.r;if(Re(r,e.from)<0)return u?Tn(u,t,r):e.l={from:t,to:r,d:1,l:null,r:null},$i(e);if(0<Re(t,e.to))return s?Tn(s,t,r):e.r={from:t,to:r,d:1,l:null,r:null},$i(e);Re(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),0<Re(r,e.to)&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1),r=!e.r,u&&!e.l&&Kn(e,u),s&&r&&Kn(e,s)}}function Kn(e,t){Fr(t)||function r(s,S){var l=S.from,h=S.to,m=S.l,S=S.r;Tn(s,l,h),m&&r(s,m),S&&r(s,S)}(e,t)}function sr(e,t){var r=Ir(t),s=r.next();if(s.done)return!1;for(var u=s.value,l=Ir(e),h=l.next(u.from),m=h.value;!s.done&&!h.done;){if(Re(m.from,u.to)<=0&&0<=Re(m.to,u.from))return!0;Re(u.from,m.from)<0?u=(s=r.next(m.from)).value:m=(h=l.next(u.from)).value}return!1}function Ir(e){var t=Fr(e)?null:{s:0,n:e};return{next:function(r){for(var s=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,s)for(;t.n.l&&Re(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!s||Re(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function $i(e){var t,r,s=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),u=1<s?"r":s<-1?"l":"";u&&(t=u=="r"?"l":"r",r=a({},e),s=e[u],e.from=s.from,e.to=s.to,e[u]=s[u],r[u]=s[t],(e[t]=r).d=Pi(r)),e.d=Pi(e)}function Pi(r){var t=r.r,r=r.l;return(t?r?Math.max(t.d,r.d):t.d:r?r.d:0)+1}function ar(e,t){return v(t).forEach(function(r){e[r]?Kn(e[r],t[r]):e[r]=function s(u){var l,h,m={};for(l in u)p(u,l)&&(h=u[l],m[l]=!h||typeof h!="object"||_e.has(h.constructor)?h:s(h));return m}(t[r])}),e}function Nr(e,t){return e.all||t.all||Object.keys(e).some(function(r){return t[r]&&sr(t[r],e[r])})}E(ut.prototype,((kt={add:function(e){return Kn(this,e),this},addKey:function(e){return Tn(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(r){return Tn(t,r,r)}),this}})[Fe]=function(){return Ir(this)},kt));var Jt={},Lr={},Hr=!1;function ur(e){ar(Lr,e),Hr||(Hr=!0,setTimeout(function(){Hr=!1,zr(Lr,!(Lr={}))},0))}function zr(e,t){t===void 0&&(t=!1);var r=new Set;if(e.all)for(var s=0,u=Object.values(Jt);s<u.length;s++)Ei(h=u[s],e,r,t);else for(var l in e){var h,m=/^idb\:\/\/(.*)\/(.*)\//.exec(l);m&&(l=m[1],m=m[2],(h=Jt["idb://".concat(l,"/").concat(m)])&&Ei(h,e,r,t))}r.forEach(function(S){return S()})}function Ei(e,t,r,s){for(var u=[],l=0,h=Object.entries(e.queries.query);l<h.length;l++){for(var m=h[l],S=m[0],k=[],j=0,b=m[1];j<b.length;j++){var O=b[j];Nr(t,O.obsSet)?O.subscribers.forEach(function($){return r.add($)}):s&&k.push(O)}s&&u.push([S,k])}if(s)for(var C=0,P=u;C<P.length;C++){var D=P[C],S=D[0],k=D[1];e.queries.query[S]=k}}function Io(e){var t=e._state,r=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Xe(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var s=t.openCanceller,u=Math.round(10*e.verno),l=!1;function h(){if(t.openCanceller!==s)throw new fe.DatabaseClosed("db.open() was cancelled")}function m(){return new se(function(O,C){if(h(),!r)throw new fe.MissingAPI;var P=e.name,D=t.autoSchema||!u?r.open(P):r.open(P,u);if(!D)throw new fe.MissingAPI;D.onerror=jt(C),D.onblocked=Ue(e._fireOnBlocked),D.onupgradeneeded=Ue(function($){var A;j=D.transaction,t.autoSchema&&!e._options.allowEmptyDB?(D.onerror=Dn,j.abort(),D.result.close(),(A=r.deleteDatabase(P)).onsuccess=A.onerror=Ue(function(){C(new fe.NoSuchDatabase("Database ".concat(P," doesnt exist")))})):(j.onerror=jt(C),$=$.oldVersion>Math.pow(2,62)?0:$.oldVersion,b=$<1,e.idbdb=D.result,l&&Mo(e,j),Bo(e,$/10,j,C))},C),D.onsuccess=Ue(function(){j=null;var $,A,x,q,M,L=e.idbdb=D.result,Z=ee(L.objectStoreNames);if(0<Z.length)try{var U=L.transaction((q=Z).length===1?q[0]:q,"readonly");if(t.autoSchema)A=L,x=U,($=e).verno=A.version/10,x=$._dbSchema=rr(0,A,x),$._storeNames=ee(A.objectStoreNames,0),tr($,[$._allTables],v(x),x);else if(ir(e,e._dbSchema,U),((M=Tr(rr(0,(M=e).idbdb,U),M._dbSchema)).add.length||M.change.some(function(te){return te.add.length||te.change.length}))&&!l)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),L.close(),u=L.version+1,l=!0,O(m());er(e,U)}catch{}hn.push(e),L.onversionchange=Ue(function(te){t.vcFired=!0,e.on("versionchange").fire(te)}),L.onclose=Ue(function(te){e.on("close").fire(te)}),b&&(M=e._deps,U=P,L=M.indexedDB,M=M.IDBKeyRange,Br(L)||U===Vn||qr(L,M).put({name:U}).catch(ye)),O()},C)}).catch(function(O){switch(O==null?void 0:O.name){case"UnknownError":if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),m();break;case"VersionError":if(0<u)return u=0,m()}return se.reject(O)})}var S,k=t.dbReadyResolve,j=null,b=!1;return se.race([s,(typeof navigator>"u"?se.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(O){function C(){return indexedDB.databases().finally(O)}S=setInterval(C,100),C()}).finally(function(){return clearInterval(S)}):Promise.resolve()).then(m)]).then(function(){return h(),t.onReadyBeingFired=[],se.resolve(Mr(function(){return e.on.ready.fire(e.vip)})).then(function O(){if(0<t.onReadyBeingFired.length){var C=t.onReadyBeingFired.reduce(He,ye);return t.onReadyBeingFired=[],se.resolve(Mr(function(){return C(e.vip)})).then(O)}})}).finally(function(){t.openCanceller===s&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(O){t.dbOpenError=O;try{j&&j.abort()}catch{}return s===t.openCanceller&&e._close(),Xe(O)}).finally(function(){t.openComplete=!0,k()}).then(function(){var O;return b&&(O={},e.tables.forEach(function(C){C.schema.indexes.forEach(function(P){P.name&&(O["idb://".concat(e.name,"/").concat(C.name,"/").concat(P.name)]=new ut(-1/0,[[[]]]))}),O["idb://".concat(e.name,"/").concat(C.name,"/")]=O["idb://".concat(e.name,"/").concat(C.name,"/:dels")]=new ut(-1/0,[[[]]])}),Lt(xn).fire(O),zr(O,!0)),e})}function Ur(e){function t(l){return e.next(l)}var r=u(t),s=u(function(l){return e.throw(l)});function u(l){return function(S){var m=l(S),S=m.value;return m.done?S:S&&typeof S.then=="function"?S.then(r,s):_(S)?Promise.all(S).then(r,s):r(S)}}return u(t)()}function lr(e,t,r){for(var s=_(e)?e.slice():[e],u=0;u<r;++u)s.push(t);return s}var No={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return a(a({},e),{table:function(t){var r=e.table(t),s=r.schema,u={},l=[];function h(b,O,C){var P=Rn(b),D=u[P]=u[P]||[],$=b==null?0:typeof b=="string"?1:b.length,A=0<O,A=a(a({},C),{name:A?"".concat(P,"(virtual-from:").concat(C.name,")"):C.name,lowLevelIndex:C,isVirtual:A,keyTail:O,keyLength:$,extractKey:Ar(b),unique:!A&&C.unique});return D.push(A),A.isPrimaryKey||l.push(A),1<$&&h($===2?b[0]:b.slice(0,$-1),O+1,C),D.sort(function(x,q){return x.keyTail-q.keyTail}),A}t=h(s.primaryKey.keyPath,0,s.primaryKey),u[":id"]=[t];for(var m=0,S=s.indexes;m<S.length;m++){var k=S[m];h(k.keyPath,0,k)}function j(b){var O,C=b.query.index;return C.isVirtual?a(a({},b),{query:{index:C.lowLevelIndex,range:(O=b.query.range,C=C.keyTail,{type:O.type===1?2:O.type,lower:lr(O.lower,O.lowerOpen?e.MAX_KEY:e.MIN_KEY,C),lowerOpen:!0,upper:lr(O.upper,O.upperOpen?e.MIN_KEY:e.MAX_KEY,C),upperOpen:!0})}}):b}return a(a({},r),{schema:a(a({},s),{primaryKey:t,indexes:l,getIndexByKeyPath:function(b){return(b=u[Rn(b)])&&b[0]}}),count:function(b){return r.count(j(b))},query:function(b){return r.query(j(b))},openCursor:function(b){var O=b.query.index,C=O.keyTail,P=O.isVirtual,D=O.keyLength;return P?r.openCursor(j(b)).then(function(A){return A&&$(A)}):r.openCursor(b);function $(A){return Object.create(A,{continue:{value:function(x){x!=null?A.continue(lr(x,b.reverse?e.MAX_KEY:e.MIN_KEY,C)):b.unique?A.continue(A.key.slice(0,D).concat(b.reverse?e.MIN_KEY:e.MAX_KEY,C)):A.continue()}},continuePrimaryKey:{value:function(x,q){A.continuePrimaryKey(lr(x,e.MAX_KEY,C),q)}},primaryKey:{get:function(){return A.primaryKey}},key:{get:function(){var x=A.key;return D===1?x[0]:x.slice(0,D)}},value:{get:function(){return A.value}}})}}})}})}};function Wr(e,t,r,s){return r=r||{},s=s||"",v(e).forEach(function(u){var l,h,m;p(t,u)?(l=e[u],h=t[u],typeof l=="object"&&typeof h=="object"&&l&&h?(m=be(l))!==be(h)?r[s+u]=t[u]:m==="Object"?Wr(l,h,r,s+u+"."):l!==h&&(r[s+u]=t[u]):l!==h&&(r[s+u]=t[u])):r[s+u]=void 0}),v(t).forEach(function(u){p(e,u)||(r[s+u]=t[u])}),r}function Yr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Lo={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return a(a({},e),{table:function(t){var r=e.table(t),s=r.schema.primaryKey;return a(a({},r),{mutate:function(u){var l=de.trans,h=l.table(t).hook,m=h.deleting,S=h.creating,k=h.updating;switch(u.type){case"add":if(S.fire===ye)break;return l._promise("readwrite",function(){return j(u)},!0);case"put":if(S.fire===ye&&k.fire===ye)break;return l._promise("readwrite",function(){return j(u)},!0);case"delete":if(m.fire===ye)break;return l._promise("readwrite",function(){return j(u)},!0);case"deleteRange":if(m.fire===ye)break;return l._promise("readwrite",function(){return function b(O,C,P){return r.query({trans:O,values:!1,query:{index:s,range:C},limit:P}).then(function(D){var $=D.result;return j({type:"delete",keys:$,trans:O}).then(function(A){return 0<A.numFailures?Promise.reject(A.failures[0]):$.length<P?{failures:[],numFailures:0,lastResult:void 0}:b(O,a(a({},C),{lower:$[$.length-1],lowerOpen:!0}),P)})})}(u.trans,u.range,1e4)},!0)}return r.mutate(u);function j(b){var O,C,P,D=de.trans,$=b.keys||Yr(s,b);if(!$)throw new Error("Keys missing");return(b=b.type==="add"||b.type==="put"?a(a({},b),{keys:$}):a({},b)).type!=="delete"&&(b.values=c([],b.values,!0)),b.keys&&(b.keys=c([],b.keys,!0)),O=r,P=$,((C=b).type==="add"?Promise.resolve([]):O.getMany({trans:C.trans,keys:P,cache:"immutable"})).then(function(A){var x=$.map(function(q,M){var L,Z,U,te=A[M],ie={onerror:null,onsuccess:null};return b.type==="delete"?m.fire.call(ie,q,te,D):b.type==="add"||te===void 0?(L=S.fire.call(ie,q,b.values[M],D),q==null&&L!=null&&(b.keys[M]=q=L,s.outbound||R(b.values[M],s.keyPath,q))):(L=Wr(te,b.values[M]),(Z=k.fire.call(ie,L,q,te,D))&&(U=b.values[M],Object.keys(Z).forEach(function(le){p(U,le)?U[le]=Z[le]:R(U,le,Z[le])}))),ie});return r.mutate(b).then(function(q){for(var M=q.failures,L=q.results,Z=q.numFailures,q=q.lastResult,U=0;U<$.length;++U){var te=(L||$)[U],ie=x[U];te==null?ie.onerror&&ie.onerror(M[U]):ie.onsuccess&&ie.onsuccess(b.type==="put"&&A[U]?b.values[U]:te)}return{failures:M,results:L,numFailures:Z,lastResult:q}}).catch(function(q){return x.forEach(function(M){return M.onerror&&M.onerror(q)}),Promise.reject(q)})})}}})}})}};function ji(e,t,r){try{if(!t||t.keys.length<e.length)return null;for(var s=[],u=0,l=0;u<t.keys.length&&l<e.length;++u)Re(t.keys[u],e[l])===0&&(s.push(r?$e(t.values[u]):t.values[u]),++l);return s.length===e.length?s:null}catch{return null}}var Ho={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return a(a({},r),{getMany:function(s){if(!s.cache)return r.getMany(s);var u=ji(s.keys,s.trans._cache,s.cache==="clone");return u?se.resolve(u):r.getMany(s).then(function(l){return s.trans._cache={keys:s.keys,values:s.cache==="clone"?$e(l):l},l})},mutate:function(s){return s.type!=="add"&&(s.trans._cache=null),r.mutate(s)}})}}}};function Di(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function xi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var zo={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new ut(e.MIN_KEY,e.MAX_KEY);return a(a({},e),{transaction:function(s,u,l){if(de.subscr&&u!=="readonly")throw new fe.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(de.querier));return e.transaction(s,u,l)},table:function(s){function u(C){var C=(P=C.query).index,P=P.range;return[C,new ut((C=P.lower)!==null&&C!==void 0?C:e.MIN_KEY,(P=P.upper)!==null&&P!==void 0?P:e.MAX_KEY)]}var l=e.table(s),h=l.schema,m=h.primaryKey,S=m.extractKey,k=m.outbound,j=a(a({},l),{mutate:function(O){function C(ie){return ie="idb://".concat(t,"/").concat(s,"/").concat(ie),x[ie]||(x[ie]=new ut)}var P,D,$,A=O.trans,x=O.mutatedParts||(O.mutatedParts={}),q=C(""),M=C(":dels"),L=O.type,te=O.type==="deleteRange"?[O.range]:O.type==="delete"?[O.keys]:O.values.length<50?[Yr(m,O).filter(function(ie){return ie}),O.values]:[],Z=te[0],U=te[1],te=O.trans._cache;return _(Z)?(q.addKeys(Z),(te=L==="delete"||Z.length===U.length?ji(Z,te):null)||M.addKeys(Z),(te||U)&&(P=C,D=te,$=U,h.indexes.forEach(function(ie){var le=P(ie.name||"");function we(Se){return Se!=null?ie.extractKey(Se):null}function Ee(Se){return ie.multiEntry&&_(Se)?Se.forEach(function(Ne){return le.addKey(Ne)}):le.addKey(Se)}(D||$).forEach(function(Se,Oe){var _t=D&&we(D[Oe]),Oe=$&&we($[Oe]);Re(_t,Oe)!==0&&(_t!=null&&Ee(_t),Oe!=null&&Ee(Oe))})}))):Z?(U={from:Z.lower,to:Z.upper},M.add(U),q.add(U)):(q.add(r),M.add(r),h.indexes.forEach(function(ie){return C(ie.name).add(r)})),l.mutate(O).then(function(ie){return!Z||O.type!=="add"&&O.type!=="put"||q.addKeys(ie.results),A.mutatedParts=ar(A.mutatedParts||{},x),ie})}}),b={get:function(O){return[m,new ut(O.key)]},getMany:function(O){return[m,new ut().addKeys(O.keys)]},count:u,query:u,openCursor:u};return v(b).forEach(function(O){j[O]=function(C){var P=de.subscr,D=!!P,$=Di(de,l)&&xi(O,C)?C.obsSet={}:P;if(D){var A=function(U){return U="idb://".concat(t,"/").concat(s,"/").concat(U),$[U]||($[U]=new ut)},x=A(""),q=A(":dels"),P=b[O](C),D=P[0],P=P[1];if((O==="query"&&D.isPrimaryKey&&!C.values?q:A(D.name||"")).add(P),!D.isPrimaryKey){if(O!=="count"){var M=O==="query"&&k&&C.values&&l.query(a(a({},C),{values:!1}));return l[O].apply(this,arguments).then(function(U){if(O==="query"){if(k&&C.values)return M.then(function(we){return we=we.result,x.addKeys(we),U});var te=C.values?U.result.map(S):U.result;(C.values?x:q).addKeys(te)}else if(O==="openCursor"){var ie=U,le=C.values;return ie&&Object.create(ie,{key:{get:function(){return q.addKey(ie.primaryKey),ie.key}},primaryKey:{get:function(){var we=ie.primaryKey;return q.addKey(we),we}},value:{get:function(){return le&&x.addKey(ie.primaryKey),ie.value}}})}return U})}q.add(r)}}return l[O].apply(this,arguments)}}),j}})}};function Ai(e,t,r){if(r.numFailures===0)return t;if(t.type==="deleteRange")return null;var s=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;return r.numFailures===s?null:(t=a({},t),_(t.keys)&&(t.keys=t.keys.filter(function(u,l){return!(l in r.failures)})),"values"in t&&_(t.values)&&(t.values=t.values.filter(function(u,l){return!(l in r.failures)})),t)}function Vr(e,t){return r=e,((s=t).lower===void 0||(s.lowerOpen?0<Re(r,s.lower):0<=Re(r,s.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?Re(e,t.upper)<0:Re(e,t.upper)<=0));var r,s}function Ri(e,t,O,s,u,l){if(!O||O.length===0)return e;var h=t.query.index,m=h.multiEntry,S=t.query.range,k=s.schema.primaryKey.extractKey,j=h.extractKey,b=(h.lowLevelIndex||h).extractKey,O=O.reduce(function(C,P){var D=C,$=P.type==="add"||P.type==="put"?P.values.filter(function(M){return M=j(M),m&&_(M)?M.some(function(L){return Vr(L,S)}):Vr(M,S)}).map(function(M){return M=$e(M),l&&Object.freeze(M),M}):[];switch(P.type){case"add":D=C.concat(t.values?$:$.map(function(L){return k(L)}));break;case"put":var A=new ut().addKeys(P.values.map(function(L){return k(L)})),D=C.filter(function(L){return L=t.values?k(L):L,!sr(new ut(L),A)}).concat(t.values?$:$.map(function(L){return k(L)}));break;case"delete":var x=new ut().addKeys(P.keys);D=C.filter(function(L){return L=t.values?k(L):L,!sr(new ut(L),x)});break;case"deleteRange":var q=P.range;D=C.filter(function(L){return!Vr(k(L),q)})}return D},e);return O===e?e:(O.sort(function(C,P){return Re(b(C),b(P))||Re(k(C),k(P))}),t.limit&&t.limit<1/0&&(O.length>t.limit?O.length=t.limit:e.length===t.limit&&O.length<t.limit&&(u.dirty=!0)),l?Object.freeze(O):O)}function Ti(e,t){return Re(e.lower,t.lower)===0&&Re(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Uo(e,t){return function(r,s,u,l){if(r===void 0)return s!==void 0?-1:0;if(s===void 0)return 1;if((s=Re(r,s))===0){if(u&&l)return 0;if(u)return 1;if(l)return-1}return s}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(r,s,u,l){if(r===void 0)return s!==void 0?1:0;if(s===void 0)return-1;if((s=Re(r,s))===0){if(u&&l)return 0;if(u)return-1;if(l)return 1}return s}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function Wo(e,t,r,s){e.subscribers.add(r),s.addEventListener("abort",function(){var u,l;e.subscribers.delete(r),e.subscribers.size===0&&(u=e,l=t,setTimeout(function(){u.subscribers.size===0&&me(l,u)},3e3))})}var Yo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name;return a(a({},e),{transaction:function(r,s,u){var l,h,m=e.transaction(r,s,u);return s==="readwrite"&&(h=(l=new AbortController).signal,u=function(S){return function(){if(l.abort(),s==="readwrite"){for(var k=new Set,j=0,b=r;j<b.length;j++){var O=b[j],C=Jt["idb://".concat(t,"/").concat(O)];if(C){var P=e.table(O),D=C.optimisticOps.filter(function(we){return we.trans===m});if(m._explicit&&S&&m.mutatedParts)for(var $=0,A=Object.values(C.queries.query);$<A.length;$++)for(var x=0,q=(Z=A[$]).slice();x<q.length;x++)Nr((U=q[x]).obsSet,m.mutatedParts)&&(me(Z,U),U.subscribers.forEach(function(we){return k.add(we)}));else if(0<D.length){C.optimisticOps=C.optimisticOps.filter(function(we){return we.trans!==m});for(var M=0,L=Object.values(C.queries.query);M<L.length;M++)for(var Z,U,te,ie=0,le=(Z=L[M]).slice();ie<le.length;ie++)(U=le[ie]).res!=null&&m.mutatedParts&&(S&&!U.dirty?(te=Object.isFrozen(U.res),te=Ri(U.res,U.req,D,P,U,te),U.dirty?(me(Z,U),U.subscribers.forEach(function(we){return k.add(we)})):te!==U.res&&(U.res=te,U.promise=se.resolve({result:te}))):(U.dirty&&me(Z,U),U.subscribers.forEach(function(we){return k.add(we)})))}}}k.forEach(function(we){return we()})}}},m.addEventListener("abort",u(!1),{signal:h}),m.addEventListener("error",u(!1),{signal:h}),m.addEventListener("complete",u(!0),{signal:h})),m},table:function(r){var s=e.table(r),u=s.schema.primaryKey;return a(a({},s),{mutate:function(l){var h=de.trans;if(u.outbound||h.db._options.cache==="disabled"||h.explicit)return s.mutate(l);var m=Jt["idb://".concat(t,"/").concat(r)];return m?(h=s.mutate(l),l.type!=="add"&&l.type!=="put"||!(50<=l.values.length||Yr(u,l).some(function(S){return S==null}))?(m.optimisticOps.push(l),l.mutatedParts&&ur(l.mutatedParts),h.then(function(S){0<S.numFailures&&(me(m.optimisticOps,l),(S=Ai(0,l,S))&&m.optimisticOps.push(S),l.mutatedParts&&ur(l.mutatedParts))}),h.catch(function(){me(m.optimisticOps,l),l.mutatedParts&&ur(l.mutatedParts)})):h.then(function(S){var k=Ai(0,a(a({},l),{values:l.values.map(function(C,b){var O,C=(O=u.keyPath)!==null&&O!==void 0&&O.includes(".")?$e(C):a({},C);return R(C,u.keyPath,S.results[b]),C})}),S);m.optimisticOps.push(k),queueMicrotask(function(){return l.mutatedParts&&ur(l.mutatedParts)})}),h):s.mutate(l)},query:function(l){if(!Di(de,s)||!xi("query",l))return s.query(l);var h=((k=de.trans)===null||k===void 0?void 0:k.db._options.cache)==="immutable",b=de,m=b.requery,S=b.signal,k=function(P,D,$,A){var x=Jt["idb://".concat(P,"/").concat(D)];if(!x)return[];if(!(D=x.queries[$]))return[null,!1,x,null];var q=D[(A.query?A.query.index.name:null)||""];if(!q)return[null,!1,x,null];switch($){case"query":var M=q.find(function(L){return L.req.limit===A.limit&&L.req.values===A.values&&Ti(L.req.query.range,A.query.range)});return M?[M,!0,x,q]:[q.find(function(L){return("limit"in L.req?L.req.limit:1/0)>=A.limit&&(!A.values||L.req.values)&&Uo(L.req.query.range,A.query.range)}),!1,x,q];case"count":return M=q.find(function(L){return Ti(L.req.query.range,A.query.range)}),[M,!!M,x,q]}}(t,r,"query",l),j=k[0],b=k[1],O=k[2],C=k[3];return j&&b?j.obsSet=l.obsSet:(b=s.query(l).then(function(P){var D=P.result;if(j&&(j.res=D),h){for(var $=0,A=D.length;$<A;++$)Object.freeze(D[$]);Object.freeze(D)}else P.result=$e(D);return P}).catch(function(P){return C&&j&&me(C,j),Promise.reject(P)}),j={obsSet:l.obsSet,promise:b,subscribers:new Set,type:"query",req:l,dirty:!1},C?C.push(j):(C=[j],(O=O||(Jt["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[l.query.index.name||""]=C)),Wo(j,C,m,S),j.promise.then(function(P){return{result:Ri(P.result,l,O==null?void 0:O.optimisticOps,s,j,h)}})}})}})}};function cr(e,t){return new Proxy(e,{get:function(r,s,u){return s==="db"?t:Reflect.get(r,s,u)}})}var Qt=(Ze.prototype.version=function(e){if(isNaN(e)||e<.1)throw new fe.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new fe.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,r=t.filter(function(s){return s._cfg.version===e})[0];return r||(r=new this.Version(e),t.push(r),t.sort(qo),r.stores({}),this._state.autoSchema=!1,r)},Ze.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||de.letThrough||this._vip)?e():new se(function(r,s){if(t._state.openComplete)return s(new fe.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void s(new fe.DatabaseClosed);t.open().catch(ye)}t._state.dbReadyPromise.then(r,s)}).then(e)},Ze.prototype.use=function(e){var t=e.stack,r=e.create,s=e.level,u=e.name;return u&&this.unuse({stack:t,name:u}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:r,level:s??10,name:u}),e.sort(function(l,h){return l.level-h.level}),this},Ze.prototype.unuse=function(e){var t=e.stack,r=e.name,s=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(u){return s?u.create!==s:!!r&&u.name!==r})),this},Ze.prototype.open=function(){var e=this;return Yt(Bt,function(){return Io(e)})},Ze.prototype._close=function(){var e=this._state,t=hn.indexOf(this);if(0<=t&&hn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.dbReadyPromise=new se(function(r){e.dbReadyResolve=r}),e.openCanceller=new se(function(r,s){e.cancelOpen=s})},Ze.prototype.close=function(e){var t=(e===void 0?{disableAutoOpen:!0}:e).disableAutoOpen,r=this.isOpen();this._close(),e=this._state,t?this._state.autoOpen=!1:r&&this._options.autoOpen&&(this._state.autoOpen=!0),e.dbOpenError=new fe.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},Ze.prototype.delete=function(){var e=this,t=0<arguments.length,r=this._state;return new se(function(s,u){function l(){e.close({disableAutoOpen:!1});var h=e._deps.indexedDB.deleteDatabase(e.name);h.onsuccess=Ue(function(){var m,S,k;m=e._deps,S=e.name,k=m.indexedDB,m=m.IDBKeyRange,Br(k)||S===Vn||qr(k,m).delete(S).catch(ye),s()}),h.onerror=jt(u),h.onblocked=e._fireOnBlocked}if(t)throw new fe.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(l):l()})},Ze.prototype.backendDB=function(){return this.idbdb},Ze.prototype.isOpen=function(){return this.idbdb!==null},Ze.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name==="DatabaseClosed"},Ze.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ze.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ze.prototype,"tables",{get:function(){var e=this;return v(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),Ze.prototype.transaction=function(){var e=(function(t,r,s){var u=arguments.length;if(u<2)throw new fe.InvalidArgument("Too few arguments");for(var l=new Array(u-1);--u;)l[u-1]=arguments[u];return s=l.pop(),[t,Pe(l),s]}).apply(this,arguments);return this._transaction.apply(this,e)},Ze.prototype._transaction=function(e,t,r){var s=this,u=de.trans;u&&u.db===this&&e.indexOf("!")===-1||(u=null);var l,h,m=e.indexOf("?")!==-1;e=e.replace("!","").replace("?","");try{if(h=t.map(function(k){if(k=k instanceof s.Table?k.name:k,typeof k!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return k}),e=="r"||e===Cr)l=Cr;else{if(e!="rw"&&e!=$r)throw new fe.InvalidArgument("Invalid transaction mode: "+e);l=$r}if(u){if(u.mode===Cr&&l===$r){if(!m)throw new fe.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u=null}u&&h.forEach(function(k){if(u&&u.storeNames.indexOf(k)===-1){if(!m)throw new fe.SubTransaction("Table "+k+" not included in parent transaction.");u=null}}),m&&u&&!u.active&&(u=null)}}catch(k){return u?u._promise(null,function(j,b){b(k)}):Xe(k)}var S=(function k(j,b,O,C,P){return se.resolve().then(function(){var D=de.transless||de,$=j._createTransaction(b,O,j._dbSchema,C);if($.explicit=!0,D={trans:$,transless:D},C)$.idbtrans=C.idbtrans;else try{$.create(),$.idbtrans._explicit=!0,j._state.PR1398_maxLoop=3}catch(q){return q.name===tt.InvalidState&&j.isOpen()&&0<--j._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),j._close(),j.open().then(function(){return k(j,b,O,null,P)})):Xe(q)}var A,x=ge(P);return x&&fn(),D=se.follow(function(){var q;(A=P.call($,$))&&(x?(q=Ft.bind(null,null),A.then(q,q)):typeof A.next=="function"&&typeof A.throw=="function"&&(A=Ur(A)))},D),(A&&typeof A.then=="function"?se.resolve(A).then(function(q){return $.active?q:Xe(new fe.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):D.then(function(){return A})).then(function(q){return C&&$._resolve(),$._completion.then(function(){return q})}).catch(function(q){return $._reject(q),Xe(q)})})}).bind(null,this,l,h,u,r);return u?u._promise(l,S,"lock"):de.trans?Yt(de.transless,function(){return s._whenReady(S)}):this._whenReady(S)},Ze.prototype.table=function(e){if(!p(this._allTables,e))throw new fe.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},Ze);function Ze(e,t){var r=this;this._middlewares={},this.verno=0;var s=Ze.dependencies;this._options=t=a({addons:Ze.addons,autoOpen:!0,indexedDB:s.indexedDB,IDBKeyRange:s.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange},s=t.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u,l,h,m,S,k={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ye,dbReadyPromise:null,cancelOpen:ye,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};k.dbReadyPromise=new se(function(b){k.dbReadyResolve=b}),k.openCanceller=new se(function(b,O){k.cancelOpen=O}),this._state=k,this.name=e,this.on=En(this,"populate","blocked","versionchange","close",{ready:[He,ye]}),this.on.ready.subscribe=V(this.on.ready.subscribe,function(b){return function(O,C){Ze.vip(function(){var P,D=r._state;D.openComplete?(D.dbOpenError||se.resolve().then(O),C&&b(O)):D.onReadyBeingFired?(D.onReadyBeingFired.push(O),C&&b(O)):(b(O),P=r,C||b(function $(){P.on.ready.unsubscribe(O),P.on.ready.unsubscribe($)}))})}}),this.Collection=(u=this,jn(jo.prototype,function(A,$){this.db=u;var C=di,P=null;if($)try{C=$()}catch(x){P=x}var D=A._ctx,$=D.table,A=$.hook.reading.fire;this._ctx={table:$,index:D.index,isPrimKey:!D.index||$.schema.primKey.keyPath&&D.index===$.schema.primKey.name,range:C,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:P,or:D.or,valueMapper:A!==z?A:null}})),this.Table=(l=this,jn(gi.prototype,function(b,O,C){this.db=l,this._tx=C,this.name=b,this.schema=O,this.hook=l._allTables[b]?l._allTables[b].hook:En(null,{creating:[nt,ye],reading:[ae,z],updating:[ke,ye],deleting:[rt,ye]})})),this.Transaction=(h=this,jn(Ao.prototype,function(b,O,C,P,D){var $=this;this.db=h,this.mode=b,this.storeNames=O,this.schema=C,this.chromeTransactionDurability=P,this.idbtrans=null,this.on=En(this,"complete","error","abort"),this.parent=D||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new se(function(A,x){$._resolve=A,$._reject=x}),this._completion.then(function(){$.active=!1,$.on.complete.fire()},function(A){var x=$.active;return $.active=!1,$.on.error.fire(A),$.parent?$.parent._reject(A):x&&$.idbtrans&&$.idbtrans.abort(),Xe(A)})})),this.Version=(m=this,jn(Fo.prototype,function(b){this.db=m,this._cfg={version:b,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(S=this,jn(wi.prototype,function(b,O,C){if(this.db=S,this._ctx={table:b,index:O===":id"?null:O,or:C},this._cmp=this._ascending=Re,this._descending=function(P,D){return Re(D,P)},this._max=function(P,D){return 0<Re(P,D)?P:D},this._min=function(P,D){return Re(P,D)<0?P:D},this._IDBKeyRange=S._deps.IDBKeyRange,!this._IDBKeyRange)throw new fe.MissingAPI})),this.on("versionchange",function(b){0<b.newVersion?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1}),r._state.openComplete=!1}),this.on("blocked",function(b){!b.newVersion||b.newVersion<b.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(b.oldVersion/10))}),this._maxKey=An(t.IDBKeyRange),this._createTransaction=function(b,O,C,P){return new r.Transaction(b,O,C,r._options.chromeTransactionDurability,P)},this._fireOnBlocked=function(b){r.on("blocked").fire(b),hn.filter(function(O){return O.name===r.name&&O!==r&&!O._state.vcFired}).map(function(O){return O.on("versionchange").fire(b)})},this.use(Ho),this.use(Yo),this.use(zo),this.use(No),this.use(Lo);var j=new Proxy(this,{get:function(b,O,C){if(O==="_vip")return!0;if(O==="table")return function(D){return cr(r.table(D),j)};var P=Reflect.get(b,O,C);return P instanceof gi?cr(P,j):O==="tables"?P.map(function(D){return cr(D,j)}):O==="_createTransaction"?function(){return cr(P.apply(this,arguments),j)}:P}});this.vip=j,s.forEach(function(b){return b(r)})}var fr,kt=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Vo=(Gr.prototype.subscribe=function(e,t,r){return this._subscribe(e&&typeof e!="function"?e:{next:e,error:t,complete:r})},Gr.prototype[kt]=function(){return this},Gr);function Gr(e){this._subscribe=e}try{fr={indexedDB:f.indexedDB||f.mozIndexedDB||f.webkitIndexedDB||f.msIndexedDB,IDBKeyRange:f.IDBKeyRange||f.webkitIDBKeyRange}}catch{fr={indexedDB:null,IDBKeyRange:null}}function Ki(e){var t,r=!1,s=new Vo(function(u){var l=ge(e),h,m=!1,S={},k={},j={get closed(){return m},unsubscribe:function(){m||(m=!0,h&&h.abort(),b&&Lt.storagemutated.unsubscribe(C))}};u.start&&u.start(j);var b=!1,O=function(){return Sr(P)},C=function(D){ar(S,D),Nr(k,S)&&O()},P=function(){var D,$,A;!m&&fr.indexedDB&&(S={},D={},h&&h.abort(),h=new AbortController,A=function(x){var q=ln();try{l&&fn();var M=Mt(e,x);return M=l?M.finally(Ft):M}finally{q&&cn()}}($={subscr:D,signal:h.signal,requery:O,querier:e,trans:null}),Promise.resolve(A).then(function(x){r=!0,t=x,m||$.signal.aborted||(S={},function(q){for(var M in q)if(p(q,M))return;return 1}(k=D)||b||(Lt(xn,C),b=!0),Sr(function(){return!m&&u.next&&u.next(x)}))},function(x){r=!1,["DatabaseClosedError","AbortError"].includes(x==null?void 0:x.name)||m||Sr(function(){m||u.error&&u.error(x)})}))};return setTimeout(O,0),j});return s.hasValue=function(){return r},s.getValue=function(){return t},s}var Xt=Qt;function Jr(e){var t=Ht;try{Ht=!0,Lt.storagemutated.fire(e),zr(e,!0)}finally{Ht=t}}E(Xt,a(a({},at),{delete:function(e){return new Xt(e,{addons:[]}).delete()},exists:function(e){return new Xt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return t=Xt.dependencies,r=t.indexedDB,t=t.IDBKeyRange,(Br(r)?Promise.resolve(r.databases()).then(function(s){return s.map(function(u){return u.name}).filter(function(u){return u!==Vn})}):qr(r,t).toCollection().primaryKeys()).then(e)}catch{return Xe(new fe.MissingAPI)}var t,r},defineClass:function(){return function(e){g(this,e)}},ignoreTransaction:function(e){return de.trans?Yt(de.transless,e):e()},vip:Mr,async:function(e){return function(){try{var t=Ur(e.apply(this,arguments));return t&&typeof t.then=="function"?t:se.resolve(t)}catch(r){return Xe(r)}}},spawn:function(e,t,r){try{var s=Ur(e.apply(r,t||[]));return s&&typeof s.then=="function"?s:se.resolve(s)}catch(u){return Xe(u)}},currentTransaction:{get:function(){return de.trans||null}},waitFor:function(e,t){return t=se.resolve(typeof e=="function"?Xt.ignoreTransaction(e):e).timeout(t||6e4),de.trans?de.trans.waitFor(t):t},Promise:se,debug:{get:function(){return ht},set:function(e){un(e)}},derive:T,extend:g,props:E,override:V,Events:En,on:Lt,liveQuery:Ki,extendObservabilitySet:ar,getByKeyPath:K,setByKeyPath:R,delByKeyPath:function(e,t){typeof t=="string"?R(e,t,void 0):"length"in t&&[].map.call(t,function(r){R(e,r,void 0)})},shallowClone:F,deepClone:$e,getObjectDiff:Wr,cmp:Re,asap:oe,minKey:-1/0,addons:[],connections:hn,errnames:tt,dependencies:fr,cache:Jt,semVer:Et,version:Et.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,r){return e+t/Math.pow(10,2*r)})})),Xt.maxKey=An(Xt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Lt(xn,function(e){var t;Ht||(Yn?(t=document.createEvent("CustomEvent")).initCustomEvent(Zn,!0,!0,e):t=new CustomEvent(Zn,{detail:e}),Ht=!0,dispatchEvent(t),Ht=!1)}),addEventListener(Zn,function(e){e=e.detail,Ht||Jr(e)}));var mn,Ht=!1,qi=function(){};return typeof BroadcastChannel<"u"&&((qi=function(){(mn=new BroadcastChannel(Zn)).onmessage=function(e){return e.data&&Jr(e.data)}})(),typeof mn.unref=="function"&&mn.unref(),Lt(xn,function(e){Ht||mn.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){e.persisted&&mn!=null&&mn.close();for(var t=0,r=hn;t<r.length;t++)r[t].close({disableAutoOpen:!1})}),addEventListener("pageshow",function(e){e.persisted&&(qi(),Jr({all:new ut(-1/0,[[]])}))})),se.rejectionMapper=function(e,t){return!e||e instanceof ce||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Je[e.name]?e:(t=new Je[e.name](t||e.message,e),"stack"in e&&N(t,"stack",{get:function(){return this.inner.stack}}),t)},un(ht),a(Qt,Object.freeze({__proto__:null,Dexie:Qt,liveQuery:Ki,Entity:pi,cmp:Re,default:Qt,RangeSet:ut,mergeRanges:Kn,rangesOverlap:sr}),{default:Qt}),Qt})})(wo);var ua=wo.exports;const ni=Gs(ua),ao=Symbol.for("Dexie"),ri=globalThis[ao]||(globalThis[ao]=ni);if(ni.semVer!==ri.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ni.semVer} and ${ri.semVer}`);class la extends ri{constructor(){super("cacheDB");he(this,"decks");this.version(1).stores({decks:"++id, text"})}}const Zr=new la;function uo(i){let n,o;return n=new aa({props:{decks:i[0],startTime:i[1]}}),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},p(a,c){const f={};c&1&&(f.decks=a[0]),c&2&&(f.startTime=a[1]),n.$set(f)},i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function ca(i){let n,o,a,c,f,v,_,g,d,y,p=i[0].length>0&&uo(i);return{c(){n=B("p"),n.textContent=`This tool gives an overview over how coverage changes with more vocab
    learned for all decks where wordcount > 3*vocabcount.`,o=Y(),a=B("p"),a.textContent="The first load may take a minute or two.",c=Y(),f=B("button"),f.textContent="Do the Thing!",v=Y(),_=B("div"),p&&p.c()},m(E,I){Q(E,n,I),Q(E,o,I),Q(E,a,I),Q(E,c,I),Q(E,f,I),Q(E,v,I),Q(E,_,I),p&&p.m(_,null),g=!0,d||(y=De(f,"click",i[2]),d=!0)},p(E,[I]){E[0].length>0?p?(p.p(E,I),I&1&&Ce(p,1)):(p=uo(E),p.c(),Ce(p,1),p.m(_,null)):p&&(wn(),je(p,1,1,()=>{p=null}),kn())},i(E){g||(Ce(p),g=!0)},o(E){je(p),g=!1},d(E){E&&(G(n),G(o),G(a),G(c),G(f),G(v),G(_)),p&&p.d(),d=!1,y()}}}function fa(i,n,o){let a;st(i,sn,d=>o(3,a=d));let c=[],f;async function v(d){var y;try{const p=(y=await Zr.decks.get(d.id))==null?void 0:y.text;if(!p)return null;const E=JSON.parse(io.decompress(p));return E.id!==d.id||E.name!==d.name||E.word_count!=d.word_count||E.vocab_count!=d.vocab_count?(await Zr.decks.delete(d.id),null):E}catch(p){return console.error(`Error loading cached element: ${p}`),null}}async function _(d){try{const y=io.compress(JSON.stringify(d));await Zr.decks.add({id:d.id,text:y})}catch(y){console.error(`Error caching element: ${y}`)}}async function g(){o(0,c=[]),o(1,f=Date.now()),console.log(`[${Date.now()-f}] Starting`);const y=(await _o(a)).filter(H=>H.word_count>H.vocab_count*3),p=[],E=[];for(const H of y){let W=await v(H);W===null&&(W=await oi(a,H),_(W)),p.push(W.vocabs),E.push(W)}console.log(`[${Date.now()-f}] Done with fetching`);const I=pr(p,1),N=await si(a,I),T=new Map;for(const H of N){const W=`${H.vid},${H.sid}`;T.set(W,H)}console.log(`[${Date.now()-f}] Done with lookup`),o(0,c=E.map(H=>{let W=[];for(const ee of H.vocabs){const V=`${ee.vid},${ee.sid}`;let X=T.get(V);W.push({...ee,state:X.state,frequency:X.frequency})}return console.log(`[${Date.now()-f}] Done with ${H.name}`),{...H,vocabs:W}}))}return[c,f,g]}class ha extends At{constructor(n){super(),xt(this,n,fa,ca,Pt,{})}}function da(i){let n,o,a,c,f,v,_,g,d,y,p,E,I,N,T,H,W,ee,V;const X=[va,ma],oe=[];function K(R,F){return R[0]===R[5].CoverageOverview?0:1}return N=K(i),T=oe[N]=X[N](i),{c(){n=B("a"),n.textContent="DeckMerger",o=Y(),a=B("a"),a.textContent="DeckYeeter",c=Y(),f=B("a"),f.textContent="DeckCoverage",v=Y(),_=B("a"),_.textContent="CoverageOverview",g=Y(),d=B("p"),d.textContent="Result:",y=Y(),p=B("pre"),E=ne(i[4]),I=Y(),T.c(),H=mo(),re(n,"href","#"),re(a,"href","#"),re(f,"href","#"),re(_,"href","#")},m(R,F){Q(R,n,F),Q(R,o,F),Q(R,a,F),Q(R,c,F),Q(R,f,F),Q(R,v,F),Q(R,_,F),Q(R,g,F),Q(R,d,F),Q(R,y,F),Q(R,p,F),w(p,E),Q(R,I,F),oe[N].m(R,F),Q(R,H,F),W=!0,ee||(V=[De(n,"click",i[7]),De(a,"click",i[8]),De(f,"click",i[9]),De(_,"click",i[10])],ee=!0)},p(R,F){(!W||F&16)&&Te(E,R[4]);let ve=N;N=K(R),N===ve?oe[N].p(R,F):(wn(),je(oe[ve],1,1,()=>{oe[ve]=null}),kn(),T=oe[N],T?T.p(R,F):(T=oe[N]=X[N](R),T.c()),Ce(T,1),T.m(H.parentNode,H))},i(R){W||(Ce(T),W=!0)},o(R){je(T),W=!1},d(R){R&&(G(n),G(o),G(a),G(c),G(f),G(v),G(_),G(g),G(d),G(y),G(p),G(I),G(H)),oe[N].d(R),ee=!1,wt(V)}}}function pa(i){let n,o;return n=new Us({}),n.$on("login",i[6]),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},p:Ie,i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function ma(i){let n,o,a,c,f,v,_,g,d,y;c=new qs({props:{decks:i[1]}});let p=i[0]===i[5].DeckMerger&&lo(),E=i[0]===i[5].DeckYeeter&&co(i),I=i[0]===i[5].DeckCoverage&&fo();return{c(){n=B("button"),n.textContent="Reload decks",o=Y(),a=B("div"),Ge(c.$$.fragment),f=Y(),p&&p.c(),v=Y(),E&&E.c(),_=Y(),I&&I.c(),re(n,"type","button"),re(a,"class","container svelte-1gcq67e")},m(N,T){Q(N,n,T),Q(N,o,T),Q(N,a,T),We(c,a,null),w(a,f),p&&p.m(a,null),w(a,v),E&&E.m(a,null),w(a,_),I&&I.m(a,null),g=!0,d||(y=De(n,"click",i[6]),d=!0)},p(N,T){const H={};T&2&&(H.decks=N[1]),c.$set(H),N[0]===N[5].DeckMerger?p?T&1&&Ce(p,1):(p=lo(),p.c(),Ce(p,1),p.m(a,v)):p&&(wn(),je(p,1,1,()=>{p=null}),kn()),N[0]===N[5].DeckYeeter?E?(E.p(N,T),T&1&&Ce(E,1)):(E=co(N),E.c(),Ce(E,1),E.m(a,_)):E&&(wn(),je(E,1,1,()=>{E=null}),kn()),N[0]===N[5].DeckCoverage?I?T&1&&Ce(I,1):(I=fo(),I.c(),Ce(I,1),I.m(a,null)):I&&(wn(),je(I,1,1,()=>{I=null}),kn())},i(N){g||(Ce(c.$$.fragment,N),Ce(p),Ce(E),Ce(I),g=!0)},o(N){je(c.$$.fragment,N),je(p),je(E),je(I),g=!1},d(N){N&&(G(n),G(o),G(a)),Ye(c),p&&p.d(),E&&E.d(),I&&I.d(),d=!1,y()}}}function va(i){let n,o;return n=new ha({}),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},p:Ie,i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function lo(i){let n,o;return n=new Fs({}),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function co(i){let n,o;return n=new Ls({}),n.$on("deleted_decks",i[6]),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},p:Ie,i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function fo(i){let n,o;return n=new Vs({}),{c(){Ge(n.$$.fragment)},m(a,c){We(n,a,c),o=!0},i(a){o||(Ce(n.$$.fragment,a),o=!0)},o(a){je(n.$$.fragment,a),o=!1},d(a){Ye(n,a)}}}function ga(i){let n,o,a,c;const f=[pa,da],v=[];function _(g,d){return g[2]?1:0}return n=_(i),o=v[n]=f[n](i),{c(){o.c(),a=mo()},m(g,d){v[n].m(g,d),Q(g,a,d),c=!0},p(g,[d]){let y=n;n=_(g),n===y?v[n].p(g,d):(wn(),je(v[y],1,1,()=>{v[y]=null}),kn(),o=v[n],o?o.p(g,d):(o=v[n]=f[n](g),o.c()),Ce(o,1),o.m(a.parentNode,a))},i(g){c||(Ce(o),c=!0)},o(g){je(o),c=!1},d(g){g&&G(a),v[n].d(g)}}}function ya(i,n,o){let a,c,f,v;st(i,sn,T=>o(11,a=T)),st(i,ti,T=>o(2,c=T)),st(i,gt,T=>o(3,f=T)),st(i,zt,T=>o(4,v=T));var _=(T=>(T[T.DeckMerger=0]="DeckMerger",T[T.DeckYeeter=1]="DeckYeeter",T[T.DeckCoverage=2]="DeckCoverage",T[T.CoverageOverview=3]="CoverageOverview",T))(_||{});let g=0,d=[];async function y(){o(1,d=await _o(a))}return[g,d,c,f,v,_,y,T=>{T.preventDefault(),o(0,g=_.DeckMerger),bt(gt,f=[],f)},T=>{T.preventDefault(),o(0,g=_.DeckYeeter),bt(gt,f=[],f)},T=>{T.preventDefault(),o(0,g=_.DeckCoverage),bt(gt,f=[],f)},T=>{T.preventDefault(),o(0,g=_.CoverageOverview),bt(gt,f=[],f)}]}class _a extends At{constructor(n){super(),xt(this,n,ya,ga,Pt,{})}}function ba(i){let n,o,a;return o=new _a({}),{c(){n=B("main"),Ge(o.$$.fragment)},m(c,f){Q(c,n,f),We(o,n,null),a=!0},p:Ie,i(c){a||(Ce(o.$$.fragment,c),a=!0)},o(c){je(o.$$.fragment,c),a=!1},d(c){c&&G(n),Ye(o)}}}class wa extends At{constructor(n){super(),xt(this,n,null,ba,Pt,{})}}new wa({target:document.getElementById("app")});
